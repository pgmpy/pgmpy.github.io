<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Structural Equation Models (SEM) &#8212; pgmpy 0.1.23 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=7b53859b" />
    <script src="../_static/documentation_options.js?v=20522496"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Naive Bayes" href="naive.html" />
    <link rel="prev" title="Dynamic Bayesian Network (DBN)" href="dbn.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-pgmpy.models.SEM">
<span id="structural-equation-models-sem"></span><h1>Structural Equation Models (SEM)<a class="headerlink" href="#module-pgmpy.models.SEM" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmpy.models.SEM.</span></span><span class="sig-name descname"><span class="pre">SEM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">syntax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEM" title="Link to this definition">¶</a></dt>
<dd><p>Class for representing Structural Equation Models. This class is a wrapper over
<cite>SEMGraph</cite> and <cite>SEMAlg</cite> to provide a consistent API over the different representations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#pgmpy.models.SEM.SEM.model" title="Link to this definition">¶</a></dt>
<dd><p>A graphical representation of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>SEMGraph instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEM.fit" title="Link to this definition">¶</a></dt>
<dd><p>Estimates the CPD for each variable based on a given data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas DataFrame object</em>) – DataFrame object with column names identical to the variable names of the network.
(If some values in the data are missing the data cells should be set to <cite>numpy.nan</cite>.
Note that pandas converts each column containing <cite>numpy.nan`s to dtype `float</cite>.)</p></li>
<li><p><strong>estimator</strong> (<em>Estimator class</em>) – One of:
- MaximumLikelihoodEstimator (default)
- BayesianEstimator: In this case, pass ‘prior_type’ and either ‘pseudo_counts’
or ‘equivalent_sample_size’ as additional keyword arguments.
See <cite>BayesianEstimator.get_parameters()</cite> for usage.
- ExpectationMaximization</p></li>
<li><p><strong>state_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>optional</em><em>)</em>) – A dict indicating, for each variable, the discrete set of states
that the variable can take. If unspecified, the observed values
in the data set are taken to be the only possible states.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> (</em><em>default: 1</em><em>)</em>) – Number of threads/processes to use for estimation. Using n_jobs &gt; 1
for small models or datasets might be slower.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Fitted Model</strong> – Returns a BayesianNetwork object with learned CPDs.
The DAG structure is preserved, and parameters (CPDs) are added.
This allows the DAG to represent both the structure and the parameters of a Bayesian Network.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="bayesiannetwork.html#pgmpy.models.BayesianNetwork.BayesianNetwork" title="pgmpy.models.BayesianNetwork.BayesianNetwork">BayesianNetwork</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.base</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted_model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">()</span>
<span class="go">[&lt;TabularCPD representing P(A:2) at 0x17945372c30&gt;,</span>
<span class="go">&lt;TabularCPD representing P(B:2) at 0x17945a19760&gt;,</span>
<span class="go">&lt;TabularCPD representing P(C:2 | A:2, B:2) at 0x17944f42690&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM.from_RAM">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_RAM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wedge_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEM.from_RAM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEM.from_RAM" title="Link to this definition">¶</a></dt>
<dd><p>Initializes a <cite>SEM</cite> instance using Reticular Action Model(RAM) notation. The model
is defined as:</p>
<p>..math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">mathbf</span><span class="p">{</span>\<span class="n">eta</span><span class="p">}</span> <span class="o">=</span> \<span class="n">mathbf</span><span class="p">{</span><span class="n">B</span> \<span class="n">eta</span><span class="p">}</span> <span class="o">+</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">epsilon</span><span class="p">}</span> \\
\<span class="n">mathbf</span><span class="p">{</span>\<span class="n">y</span><span class="p">}</span> <span class="o">=</span> \<span class="n">wedge_y</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">eta</span><span class="p">}</span>
\<span class="n">zeta</span> <span class="o">=</span> <span class="n">COV</span><span class="p">(</span>\<span class="n">mathbf</span><span class="p">{</span>\<span class="n">epsilon</span><span class="p">})</span>
</pre></div>
</div>
<p>where <img class="math" src="../_images/math/ee5857aac2f27f5a6e25fb602bf1f9082f2e9d19.png" alt="\mathbf{\eta}"/> is the set of variables (both latent and observed),
<img class="math" src="../_images/math/a8821c6d89933317f0e752f152acc409f6560920.png" alt="\mathbf{\epsilon}"/> are the error terms, <img class="math" src="../_images/math/b04f62e21c4cd0ae0183708ab43bd04d6a0579f7.png" alt="\mathbf{y}"/> is the set
of observed variables, <img class="math" src="../_images/math/73fd3fd745ca7db10eaf95f28e3458a705c6d26f.png" alt="\wedge_y"/> is a boolean array of the shape (no of
observed variables, no of total variables).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>array-like</em>) – List of variables (both latent and observed) in the model.</p></li>
<li><p><strong>B</strong> (2-D boolean array (shape: <cite>len(variables)</cite> x <cite>len(variables)</cite>)) – The non-zero parameters in <img class="math" src="../_images/math/4bc3e94a67870b41b7c20179693e889251e2c136.png" alt="B"/> matrix. Refer model definition in docstring for details.</p></li>
<li><p><strong>zeta</strong> (2-D boolean array (shape: <cite>len(variables)</cite> x <cite>len(variables)</cite>)) – The non-zero parameters in <img class="math" src="../_images/math/3ef1157ea7221d7eda6098e1fd7a04a28a555e6d.png" alt="\zeta"/> (error covariance) matrix. Refer model definition
in docstring for details.</p></li>
<li><p><strong>observed</strong> (list, array-like (optional: Either <cite>observed</cite> or <cite>wedge_y</cite> needs to be specified)) – List of observed variables in the model.</p></li>
<li><p><strong>wedge_y</strong> (2-D array (shape: no. observed x total vars) (optional: Either <cite>observed</cite> or <cite>wedge_y</cite>)) – The <img class="math" src="../_images/math/73fd3fd745ca7db10eaf95f28e3458a705c6d26f.png" alt="\wedge_y"/> matrix. Refer model definition in docstring for details.</p></li>
<li><p><strong>fixed_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>optional</em><em>)</em>) – If specified, fixes the parameter values and are not changed during estimation.
A dict with the keys B, zeta.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pgmpy.models.SEM instance</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of the object with initialized values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SEM</span><span class="o">.</span><span class="n">from_RAM</span>  <span class="c1"># TODO: Finish this</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM.from_graph">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebunch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEM.from_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEM.from_graph" title="Link to this definition">¶</a></dt>
<dd><p>Initializes a <cite>SEM</cite> instance using graphical structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ebunch</strong> (<em>list/array-like</em>) – <dl class="simple">
<dt>List of edges in form of tuples. Each tuple can be of two possible shape:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>(u, v): This would add an edge from u to v without setting any parameter</dt><dd><p>for the edge.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>(u, v, parameter): This would add an edge from u to v and set the edge’s</dt><dd><p>parameter to <cite>parameter</cite>.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</p></li>
<li><p><strong>latents</strong> (<em>list/array-like</em>) – List of nodes which are latent. All other variables are considered observed.</p></li>
<li><p><strong>err_corr</strong> (<em>list/array-like</em>) – <dl class="simple">
<dt>List of tuples representing edges between error terms. It can be of the following forms:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>(u, v): Add correlation between error terms of <cite>u</cite> and <cite>v</cite>. Doesn’t set any variance or</dt><dd><p>covariance values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>(u, v, covar): Adds correlation between the error terms of <cite>u</cite> and <cite>v</cite> and sets the</dt><dd><p>parameter to <cite>covar</cite>.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</p></li>
<li><p><strong>err_var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dict of the form (var: variance).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Defining a model (Union sentiment model[1]) without setting any paramaters.
&gt;&gt;&gt; from pgmpy.models import SEM
&gt;&gt;&gt; sem = SEM.from_graph(ebunch=[(‘deferenc’, ‘unionsen’), (‘laboract’, ‘unionsen’),
…                              (‘yrsmill’, ‘unionsen’), (‘age’, ‘deferenc’),
…                              (‘age’, ‘laboract’), (‘deferenc’, ‘laboract’)],
…                      latents=[],
…                      err_corr=[(‘yrsmill’, ‘age’)],
…                      err_var={})</p>
<p>Defining a model (Education [2]) with all the parameters set. For not setting any
parameter <cite>np.nan</cite> can be explicitly passed.
&gt;&gt;&gt; sem_edu = SEM.from_graph(ebunch=[(‘intelligence’, ‘academic’, 0.8), (‘intelligence’, ‘scale_1’, 0.7),
…                                  (‘intelligence’, ‘scale_2’, 0.64), (‘intelligence’, ‘scale_3’, 0.73),
…                                  (‘intelligence’, ‘scale_4’, 0.82), (‘academic’, ‘SAT_score’, 0.98),
…                                  (‘academic’, ‘High_school_gpa’, 0.75), (‘academic’, ‘ACT_score’, 0.87)],
…                          latents=[‘intelligence’, ‘academic’],
…                          err_corr=[],
…                          err_var={})</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] McDonald, A, J., &amp; Clelland, D. A. (1984). Textile Workers and Union Sentiment.</dt><dd><p>Social Forces, 63(2), 502–521</p>
</dd>
<dt>[2] <a class="reference external" href="https://en.wikipedia.org/wiki/Structural_equation_modeling#/">https://en.wikipedia.org/wiki/Structural_equation_modeling#/</a></dt><dd><p>media/<a class="reference external" href="File:Example_Structural_equation_model.svg">File:Example_Structural_equation_model.svg</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM.from_lavaan">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_lavaan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEM.from_lavaan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEM.from_lavaan" title="Link to this definition">¶</a></dt>
<dd><p>Initializes a <cite>SEM</cite> instance using lavaan syntax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> (</em><em>default: None</em><em>)</em>) – A <cite>lavaan</cite> style multiline set of regression equation representing the model.
Refer <a class="reference external" href="http://lavaan.ugent.be/tutorial/syntax1.html">http://lavaan.ugent.be/tutorial/syntax1.html</a> for details.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> (</em><em>default: None</em><em>)</em>) – The filename of the file containing the model in lavaan syntax.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEM.from_lisrel">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_lisrel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEM.from_lisrel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEM.from_lisrel" title="Link to this definition">¶</a></dt>
<dd><p>Initializes a <cite>SEM</cite> instance using LISREL notation. The LISREL notation is defined as:
..math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">mathbf</span><span class="p">{</span>\<span class="n">eta</span><span class="p">}</span> <span class="o">=</span> \<span class="n">mathbf</span><span class="p">{</span><span class="n">B</span> \<span class="n">eta</span><span class="p">}</span> <span class="o">+</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">Gamma</span> \<span class="n">xi</span><span class="p">}</span> <span class="o">+</span> <span class="n">mathbf</span><span class="p">{</span>\<span class="n">zeta</span><span class="p">}</span> \\
\<span class="n">mathbf</span><span class="p">{</span><span class="n">y</span><span class="p">}</span> <span class="o">=</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">wedge_y</span> \<span class="n">eta</span><span class="p">}</span> <span class="o">+</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">epsilon</span><span class="p">}</span> \\
\<span class="n">mathbf</span><span class="p">{</span><span class="n">x</span><span class="p">}</span> <span class="o">=</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">wedge_x</span> \<span class="n">xi</span><span class="p">}</span> <span class="o">+</span> \<span class="n">mathbf</span><span class="p">{</span>\<span class="n">delta</span><span class="p">}</span>
</pre></div>
</div>
<p>where <img class="math" src="../_images/math/ee5857aac2f27f5a6e25fb602bf1f9082f2e9d19.png" alt="\mathbf{\eta}"/> is the set of endogenous variables, <img class="math" src="../_images/math/372d6f0a7e8f6120f4af2bd45cc0a389a076e3e3.png" alt="\mathbf{\xi}"/>
is the set of exogeneous variables, <img class="math" src="../_images/math/b04f62e21c4cd0ae0183708ab43bd04d6a0579f7.png" alt="\mathbf{y}"/> and <img class="math" src="../_images/math/5369e693370bbbd19fea43055b8f96596bff42a6.png" alt="\mathbf{x}"/> are the
set of measurement variables for <img class="math" src="../_images/math/ee5857aac2f27f5a6e25fb602bf1f9082f2e9d19.png" alt="\mathbf{\eta}"/> and <img class="math" src="../_images/math/372d6f0a7e8f6120f4af2bd45cc0a389a076e3e3.png" alt="\mathbf{\xi}"/>
respectively. <img class="math" src="../_images/math/35dac3dcc0772a547022e78872dd5a833cb2fef2.png" alt="\mathbf{\zeta}"/>, <img class="math" src="../_images/math/a8821c6d89933317f0e752f152acc409f6560920.png" alt="\mathbf{\epsilon}"/>, and <img class="math" src="../_images/math/60a1010c99ffe8f9d3ec9609a1d88f38b72a9c60.png" alt="\mathbf{\delta}"/>
are the error terms for <img class="math" src="../_images/math/ee5857aac2f27f5a6e25fb602bf1f9082f2e9d19.png" alt="\mathbf{\eta}"/>, <img class="math" src="../_images/math/b04f62e21c4cd0ae0183708ab43bd04d6a0579f7.png" alt="\mathbf{y}"/>, and <img class="math" src="../_images/math/5369e693370bbbd19fea43055b8f96596bff42a6.png" alt="\mathbf{x}"/>
respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>str_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> (</em><em>default: None</em><em>)</em>) – <p>A <cite>lavaan</cite> style multiline set of regression equation representing the model.
Refer <a class="reference external" href="http://lavaan.ugent.be/tutorial/syntax1.html">http://lavaan.ugent.be/tutorial/syntax1.html</a> for details.</p>
<p>If None requires <cite>var_names</cite> and <cite>params</cite> to be specified.</p>
</p></li>
<li><p><strong>var_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>default: None</em><em>)</em>) – A dict with the keys: eta, xi, y, and x. Each keys should have a list as the value
with the name of variables.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>default: None</em><em>)</em>) – <p>A dict of LISREL representation non-zero parameters. Must contain the following
keys: B, gamma, wedge_y, wedge_x, phi, theta_e, theta_del, and psi.</p>
<p>If None <cite>str_model</cite> must be specified.</p>
</p></li>
<li><p><strong>fixed_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>default: None</em><em>)</em>) – <p>A dict of fixed values for parameters. The shape of the parameters should be same
as params.</p>
<p>If None all the parameters are learnable.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pgmpy.models.SEM instance</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of the object with initalized values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEMAlg</span>
<span class="go"># TODO: Finish this example</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMAlg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmpy.models.SEM.</span></span><span class="sig-name descname"><span class="pre">SEMAlg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wedge_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMAlg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMAlg" title="Link to this definition">¶</a></dt>
<dd><p>Base class for algebraic representation of Structural Equation Models(SEMs). The model is
represented using the Reticular Action Model (RAM).</p>
<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMAlg.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMAlg.generate_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMAlg.generate_samples" title="Link to this definition">¶</a></dt>
<dd><p>Generates random samples from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of samples to generate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pd.DataFrame</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The generated samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMAlg.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMAlg.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMAlg.set_params" title="Link to this definition">¶</a></dt>
<dd><p>Sets the fixed parameters of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>B</strong> (<em>2D array</em>) – The B matrix.</p></li>
<li><p><strong>zeta</strong> (<em>2D array</em>) – The covariance matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMAlg.to_SEMGraph">
<span class="sig-name descname"><span class="pre">to_SEMGraph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMAlg.to_SEMGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMAlg.to_SEMGraph" title="Link to this definition">¶</a></dt>
<dd><p>Creates a graph structure from the LISREL representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pgmpy.models.SEMGraph instance</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A path model of the model.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEMAlg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SEMAlg</span><span class="p">()</span>
<span class="go"># TODO: Finish this example</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pgmpy.models.SEM.</span></span><span class="sig-name descname"><span class="pre">SEMGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebunch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph" title="Link to this definition">¶</a></dt>
<dd><p>Base class for graphical representation of Structural Equation Models(SEMs).</p>
<p>All variables are by default assumed to have an associated error latent variable, therefore
doesn’t need to be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ebunch</strong> (<em>list/array-like</em>) – <dl class="simple">
<dt>List of edges in form of tuples. Each tuple can be of two possible shape:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>(u, v): This would add an edge from u to v without setting any parameter</dt><dd><p>for the edge.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>(u, v, parameter): This would add an edge from u to v and set the edge’s</dt><dd><p>parameter to <cite>parameter</cite>.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</p></li>
<li><p><strong>latents</strong> (<em>list/array-like</em>) – List of nodes which are latent. All other variables are considered observed.</p></li>
<li><p><strong>err_corr</strong> (<em>list/array-like</em>) – <dl class="simple">
<dt>List of tuples representing edges between error terms. It can be of the following forms:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>(u, v): Add correlation between error terms of <cite>u</cite> and <cite>v</cite>. Doesn’t set any variance or</dt><dd><p>covariance values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>(u, v, covar): Adds correlation between the error terms of <cite>u</cite> and <cite>v</cite> and sets the</dt><dd><p>parameter to <cite>covar</cite>.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</p></li>
<li><p><strong>err_var</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>variable: variance</em><em>)</em>) – Sets variance for the error terms in the model.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Defining a model (Union sentiment model[1]) without setting any paramaters.
&gt;&gt;&gt; from pgmpy.models import SEMGraph
&gt;&gt;&gt; sem = SEMGraph(ebunch=[(‘deferenc’, ‘unionsen’), (‘laboract’, ‘unionsen’),
…                        (‘yrsmill’, ‘unionsen’), (‘age’, ‘deferenc’),
…                        (‘age’, ‘laboract’), (‘deferenc’, ‘laboract’)],
…                latents=[],
…                err_corr=[(‘yrsmill’, ‘age’)],
…                err_var={})</p>
<p>Defining a model (Education [2]) with all the parameters set. For not setting any
parameter <cite>np.nan</cite> can be explicitly passed.
&gt;&gt;&gt; sem_edu = SEMGraph(ebunch=[(‘intelligence’, ‘academic’, 0.8), (‘intelligence’, ‘scale_1’, 0.7),
…                            (‘intelligence’, ‘scale_2’, 0.64), (‘intelligence’, ‘scale_3’, 0.73),
…                            (‘intelligence’, ‘scale_4’, 0.82), (‘academic’, ‘SAT_score’, 0.98),
…                            (‘academic’, ‘High_school_gpa’, 0.75), (‘academic’, ‘ACT_score’, 0.87)],
…                    latents=[‘intelligence’, ‘academic’],
…                    err_corr=[],
…                    err_var={‘intelligence’: 1})</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] McDonald, A, J., &amp; Clelland, D. A. (1984). Textile Workers and Union Sentiment.</dt><dd><p>Social Forces, 63(2), 502–521</p>
</dd>
<dt>[2] <a class="reference external" href="https://en.wikipedia.org/wiki/Structural_equation_modeling#/">https://en.wikipedia.org/wiki/Structural_equation_modeling#/</a></dt><dd><p>media/<a class="reference external" href="File:Example_Structural_equation_model.svg">File:Example_Structural_equation_model.svg</a></p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.latents">
<span class="sig-name descname"><span class="pre">latents</span></span><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.latents" title="Link to this definition">¶</a></dt>
<dd><p>List of all the latent variables in the model except the error terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.observed">
<span class="sig-name descname"><span class="pre">observed</span></span><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.observed" title="Link to this definition">¶</a></dt>
<dd><p>List of all the observed variables in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.graph" title="Link to this definition">¶</a></dt>
<dd><p>The graphical structure of the latent and observed variables except the error terms.
The parameters are stored in the <cite>weight</cite> attribute of each edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nx.DirectedGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.err_graph">
<span class="sig-name descname"><span class="pre">err_graph</span></span><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.err_graph" title="Link to this definition">¶</a></dt>
<dd><p>An undirected graph representing the relations between the error terms of the model.
The node of the graph has the same name as the variable but represents the error terms.
The variance is stored in the <cite>weight</cite> attribute of the node and the covariance are stored
in the <cite>weight</cite> attribute of the edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nx.Graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.full_graph_struct">
<span class="sig-name descname"><span class="pre">full_graph_struct</span></span><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.full_graph_struct" title="Link to this definition">¶</a></dt>
<dd><p>Represents the full graph structure. The names of error terms start with <cite>.</cite> and
new nodes are added for each correlation which starts with <cite>..</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nx.DiGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.active_trail_nodes">
<span class="sig-name descname"><span class="pre">active_trail_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avoid_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">struct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.active_trail_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.active_trail_nodes" title="Link to this definition">¶</a></dt>
<dd><p>Finds all the observed variables which are d-connected to <cite>variables</cite> in the <cite>graph_struct</cite>
when <cite>observed</cite> variables are observed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>array like</em>) – Observed variables whose d-connected variables are to be found.</p></li>
<li><p><strong>observed</strong> (<em>list/array-like</em>) – If given the active trails would be computed assuming these nodes to be observed.</p></li>
<li><p><strong>avoid_nodes</strong> (<em>list/array-like</em>) – If specificed, the algorithm doesn’t account for paths that have influence flowing
through the avoid node.</p></li>
<li><p><strong>struct</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>nx.DiGraph instance</em>) – If “full”, considers correlation between error terms for computing d-connection.
If “non_error”, doesn’t condised error correlations for computing d-connection.
If instance of nx.DiGraph, finds d-connected variables on the given graph.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SEMGraph</span><span class="p">(</span><span class="n">ebunch</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;yrsmill&#39;</span><span class="p">,</span> <span class="s1">&#39;unionsen&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;laboract&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;deferenc&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;deferenc&#39;</span><span class="p">,</span> <span class="s1">&#39;laboract&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;deferenc&#39;</span><span class="p">,</span> <span class="s1">&#39;unionsen&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;laboract&#39;</span><span class="p">,</span> <span class="s1">&#39;unionsen&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                 <span class="n">latents</span><span class="o">=</span><span class="p">[],</span>
<span class="gp">... </span>                 <span class="n">err_corr</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;yrsmill&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">active_trail_nodes</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dict</strong> – Returns a dict with <cite>variables</cite> as the key and a list of d-connected variables as the
value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>{str: list}</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Details of the algorithm can be found in ‘Probabilistic Graphical Model
Principles and Techniques’ - Koller and Friedman
Page 75 Algorithm 3.1</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.get_conditional_ivs">
<span class="sig-name descname"><span class="pre">get_conditional_ivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_indicators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.get_conditional_ivs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.get_conditional_ivs" title="Link to this definition">¶</a></dt>
<dd><p>Returns the conditional IVs for the relation X -&gt; Y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>node</em>) – The observed variable’s name</p></li>
<li><p><strong>Y</strong> (<em>node</em>) – The oberved variable’s name</p></li>
<li><p><strong>scaling_indicators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>optional</em><em>)</em>) – A dict representing which observed variable to use as scaling indicator for
the latent variables.
If not provided, automatically finds scaling indicators by randomly selecting
one of the measurement variables of each latent variable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>set</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set of 2-tuples representing tuple[0] is an IV for X -&gt; Y given tuple[1].</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Van Der Zander, B., Textor, J., &amp; Liskiewicz, M. (2015, June). Efficiently finding
conditional instruments for causal inference. In Twenty-Fourth International Joint
Conference on Artificial Intelligence.</p>
</aside>
</aside>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEMGraph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SEMGraph</span><span class="p">(</span><span class="n">ebunch</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                 <span class="n">latents</span><span class="o">=</span><span class="p">[],</span>
<span class="gp">... </span>                 <span class="n">err_corr</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_ivs</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="go">[(&#39;I&#39;, {&#39;W&#39;})]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.get_ivs">
<span class="sig-name descname"><span class="pre">get_ivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_indicators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.get_ivs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.get_ivs" title="Link to this definition">¶</a></dt>
<dd><p>Returns the Instrumental variables(IVs) for the relation X -&gt; Y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>node</em>) – The variable name (observed or latent)</p></li>
<li><p><strong>Y</strong> (<em>node</em>) – The variable name (observed or latent)</p></li>
<li><p><strong>scaling_indicators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> (</em><em>optional</em><em>)</em>) – A dict representing which observed variable to use as scaling indicator for
the latent variables.
If not given the method automatically selects one of the measurement variables
at random as the scaling indicator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>set</strong> – The set of Instrumental Variables for X -&gt; Y.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{str}</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEMGraph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SEMGraph</span><span class="p">(</span><span class="n">ebunch</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                 <span class="n">latents</span><span class="o">=</span><span class="p">[],</span>
<span class="gp">... </span>                 <span class="n">err_corr</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_ivs</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="go">{&#39;I&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.get_scaling_indicators">
<span class="sig-name descname"><span class="pre">get_scaling_indicators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.get_scaling_indicators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.get_scaling_indicators" title="Link to this definition">¶</a></dt>
<dd><p>Returns a scaling indicator for each of the latent variables in the model.
The scaling indicator is chosen randomly among the observed measurement
variables of the latent variable.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEMGraph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SEMGraph</span><span class="p">(</span><span class="n">ebunch</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;xi1&#39;</span><span class="p">,</span> <span class="s1">&#39;eta1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;xi1&#39;</span><span class="p">,</span> <span class="s1">&#39;x1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;xi1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;eta1&#39;</span><span class="p">,</span> <span class="s1">&#39;y1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;eta1&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                 <span class="n">latents</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;xi1&#39;</span><span class="p">,</span> <span class="s1">&#39;eta1&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">get_scaling_indicators</span><span class="p">()</span>
<span class="go">{&#39;xi1&#39;: &#39;x1&#39;, &#39;eta1&#39;: &#39;y1&#39;}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dict</strong> – scaling indicator.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a dict with latent variables as the key and their value being the</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.moralize">
<span class="sig-name descname"><span class="pre">moralize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.moralize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.moralize" title="Link to this definition">¶</a></dt>
<dd><p>TODO: This needs to go to a parent class.
Removes all the immoralities in the DirectedGraph and creates a moral
graph (UndirectedGraph).</p>
<p>A v-structure X-&gt;Z&lt;-Y is an immorality if there is no directed edge
between X and Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graph</strong></p>
</dd>
</dl>
<p class="rubric">Examples</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.to_lisrel">
<span class="sig-name descname"><span class="pre">to_lisrel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.to_lisrel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.to_lisrel" title="Link to this definition">¶</a></dt>
<dd><p>Converts the model from a graphical representation to an equivalent algebraic
representation. This converts the model into a Reticular Action Model (RAM) model
representation which is implemented by <cite>pgmpy.models.SEMAlg</cite> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SEMAlg instance</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Instance of <cite>SEMAlg</cite> representing the model.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">SEM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sem</span> <span class="o">=</span> <span class="n">SEM</span><span class="o">.</span><span class="n">from_graph</span><span class="p">(</span><span class="n">ebunch</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;deferenc&#39;</span><span class="p">,</span> <span class="s1">&#39;unionsen&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;laboract&#39;</span><span class="p">,</span> <span class="s1">&#39;unionsen&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="p">(</span><span class="s1">&#39;yrsmill&#39;</span><span class="p">,</span> <span class="s1">&#39;unionsen&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;deferenc&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;laboract&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;deferenc&#39;</span><span class="p">,</span> <span class="s1">&#39;laboract&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">latents</span><span class="o">=</span><span class="p">[],</span>
<span class="gp">... </span>                     <span class="n">err_corr</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;yrsmill&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">err_var</span><span class="o">=</span><span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sem</span><span class="o">.</span><span class="n">to_lisrel</span><span class="p">()</span>
<span class="go"># TODO: Complete this.</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pgmpy.models.SEM.SEMGraph.to_standard_lisrel" title="pgmpy.models.SEM.SEMGraph.to_standard_lisrel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_standard_lisrel</span></code></a></dt><dd><p>Converts to the standard lisrel format and returns the parameters.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pgmpy.models.SEM.SEMGraph.to_standard_lisrel">
<span class="sig-name descname"><span class="pre">to_standard_lisrel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pgmpy/models/SEM.html#SEMGraph.to_standard_lisrel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pgmpy.models.SEM.SEMGraph.to_standard_lisrel" title="Link to this definition">¶</a></dt>
<dd><p>Transforms the model to the standard LISREL representation of latent and measurement
equations. The standard LISREL representation is given as:</p>
<dl class="simple">
<dt>..math::</dt><dd><p>mathbf{eta} = mathbf{B eta} + mathbf{Gamma xi} + mathbf{zeta} \
mathbf{y} = mathbf{wedge_y eta} + mathbf{epsilon} \
mathbf{x} = mathbf{wedge_x xi} + mathbf{delta} \
mathbf{Theta_e} = COV(mathbf{epsilon}) \
mathbf{Theta_delta} = COV(mathbf{delta}) \
mathbf{Psi} = COV(mathbf{eta}) \
mathbf{Phi} = COV(mathbf{xi}) \</p>
</dd>
</dl>
<p>Since the standard LISREL representation has restrictions on the types of model,
this method adds extra latent variables with fixed loadings of <cite>1</cite> to make the model
consistent with the restrictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>var_names</strong> (<em>dict (keys: eta, xi, y, x)</em>) – Returns the variable names in <img class="math" src="../_images/math/ee5857aac2f27f5a6e25fb602bf1f9082f2e9d19.png" alt="\mathbf{\eta}"/>, <img class="math" src="../_images/math/372d6f0a7e8f6120f4af2bd45cc0a389a076e3e3.png" alt="\mathbf{\xi}"/>,
<img class="math" src="../_images/math/b04f62e21c4cd0ae0183708ab43bd04d6a0579f7.png" alt="\mathbf{y}"/>, <img class="math" src="../_images/math/5369e693370bbbd19fea43055b8f96596bff42a6.png" alt="\mathbf{x}"/>.</p></li>
<li><p><strong>params</strong> (<em>dict (keys: B, gamma, wedge_y, wedge_x, theta_e, theta_del, phi, psi)</em>) – Returns a boolean matrix for each of the parameters. A 1 in the matrix
represents that there is an edge in the model, 0 represents there is no edge.</p></li>
<li><p><strong>fixed_values</strong> (<em>dict (keys: B, gamma, wedge_y, wedge_x, theta_e, theta_del, phi, psi)</em>) – Returns a matrix for each of the parameters. A value in the matrix represents the
set value for the parameter in the model else it is 0.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pgmpy.models.SEM.SEMGraph.to_lisrel" title="pgmpy.models.SEM.SEMGraph.to_lisrel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_lisrel</span></code></a></dt><dd><p>Converts the model to <cite>pgmpy.models.SEMAlg</cite> instance.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>TODO: Finish this.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../started/base.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base/base.html">Base Model Structures</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="base.html">Models</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bayesiannetwork.html">Bayesian Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="gaussianbn.html">Linear Gaussian Bayesian Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="dbn.html">Dynamic Bayesian Network (DBN)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Structural Equation Models (SEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="naive.html">Naive Bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="markovnetwork.html">Markov Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="junctiontree.html">Junction Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="clustergraph.html">Cluster Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="factorgraph.html">Factor Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="markovchain.html">Markov Chain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../factors/base.html">Parameterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exact_infer/base.html">Exact Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exact_infer/model_testing.html">Model Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../approx_infer/base.html">Approximate Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../param_estimator/base.html">Parameter Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure_estimator/base.html">Structure Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metrics for testing models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readwrite/base.html">Reading/Writing to File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial Notebooks</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="base.html">Models</a><ul>
      <li>Previous: <a href="dbn.html" title="previous chapter">Dynamic Bayesian Network (DBN)</a></li>
      <li>Next: <a href="naive.html" title="next chapter">Naive Bayes</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>







<script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>

<div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="horizontal"></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HCFR07M31W');
</script>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Ankur Ankan.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/models/sem.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>