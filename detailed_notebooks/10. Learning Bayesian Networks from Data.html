
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Learning Bayesian Networks from Data &#8212; pgmpy 0.1.23 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy" href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html" />
    <link rel="prev" title="Reading and Writing from pgmpy file formats" href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Learning-Bayesian-Networks-from-Data">
<h1>Learning Bayesian Networks from Data<a class="headerlink" href="#Learning-Bayesian-Networks-from-Data" title="Permalink to this heading">¶</a></h1>
<p>Previous notebooks showed how Bayesian networks economically encode a probability distribution over a set of variables, and how they can be used e.g. to predict variable states, or to generate new samples from the joint distribution. This section will be about obtaining a Bayesian network, given a set of sample data. Learning a Bayesian network can be split into two problems:</p>
<p><strong>Parameter learning:</strong> Given a set of data samples and a DAG that captures the dependencies between the variables, estimate the (conditional) probability distributions of the individual variables.</p>
<p><strong>Structure learning:</strong> Given a set of data samples, estimate a DAG that captures the dependencies between the variables.</p>
<p>This notebook aims to illustrate how parameter learning and structure learning can be done with pgmpy. Currently, the library supports: - Parameter learning for <em>discrete</em> nodes: - Maximum Likelihood Estimation - Bayesian Estimation - Structure learning for <em>discrete</em>, <em>fully observed</em> networks: - Score-based structure estimation (BIC/BDeu/K2 score; exhaustive search, hill climb/tabu search) - Constraint-based structure estimation (PC) - Hybrid structure estimation (MMHC)</p>
<section id="Parameter-Learning">
<h2>Parameter Learning<a class="headerlink" href="#Parameter-Learning" title="Permalink to this heading">¶</a></h2>
<p>Suppose we have the following data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fruit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,],</span>
                          <span class="s1">&#39;tasty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">],</span>
                          <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;large&quot;</span><span class="p">,</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;small&quot;</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
     fruit tasty   size
0   banana   yes  large
1    apple    no  large
2   banana   yes  large
3    apple   yes  small
4   banana   yes  large
5    apple   yes  large
6   banana   yes  large
7    apple   yes  small
8    apple   yes  large
9    apple   yes  large
10  banana   yes  large
11  banana    no  large
12   apple    no  small
13  banana    no  small
</pre></div></div>
</div>
<p>We know that the variables relate as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="s1">&#39;tasty&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;tasty&#39;</span><span class="p">)])</span>  <span class="c1"># fruit -&gt; tasty &lt;- size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ankur/pgmpy_notebook/notebooks/pgmpy/models/BayesianModel.py:8: FutureWarning: BayesianModel has been renamed to BayesianNetwork. Please use BayesianNetwork class, BayesianModel will be removed in future.
  warnings.warn(
</pre></div></div>
</div>
<p>Parameter learning is the task to estimate the values of the conditional probability distributions (CPDs), for the variables <code class="docutils literal notranslate"><span class="pre">fruit</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, and <code class="docutils literal notranslate"><span class="pre">tasty</span></code>.</p>
<section id="State-counts">
<h3>State counts<a class="headerlink" href="#State-counts" title="Permalink to this heading">¶</a></h3>
<p>To make sense of the given data, we can start by counting how often each state of the variable occurs. If the variable is dependent on parents, the counts are done conditionally on the parents states, i.e. for seperately for each parent configuration:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">ParameterEstimator</span>
<span class="n">pe</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pe</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;fruit&#39;</span><span class="p">))</span>  <span class="c1"># unconditional</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pe</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;tasty&#39;</span><span class="p">))</span>  <span class="c1"># conditional on fruit and size</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

         fruit
apple       7
banana      7

 fruit apple       banana
size  large small  large small
tasty
no      1.0   1.0    1.0   1.0
yes     3.0   2.0    5.0   0.0
</pre></div></div>
</div>
<p>We can see, for example, that as many apples as bananas were observed and that <code class="docutils literal notranslate"><span class="pre">5</span></code> large bananas were tasty, while only <code class="docutils literal notranslate"><span class="pre">1</span></code> was not.</p>
</section>
<section id="Maximum-Likelihood-Estimation">
<h3>Maximum Likelihood Estimation<a class="headerlink" href="#Maximum-Likelihood-Estimation" title="Permalink to this heading">¶</a></h3>
<p>A natural estimate for the CPDs is to simply use the <em>relative frequencies</em>, with which the variable states have occured. We observed <code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">apples</span></code> among a total of <code class="docutils literal notranslate"><span class="pre">14</span> <span class="pre">fruits</span></code>, so we might guess that about <code class="docutils literal notranslate"><span class="pre">50%</span></code> of <code class="docutils literal notranslate"><span class="pre">fruits</span></code> are <code class="docutils literal notranslate"><span class="pre">apples</span></code>.</p>
<p>This approach is <em>Maximum Likelihood Estimation (MLE)</em>. According to MLE, we should fill the CPDs in such a way, that <img class="math" src="../_images/math/8fd1ecbd7acec74f610cb9286c255807885fe370.png" alt="P(\text{data}|\text{model})"/> is maximal. This is achieved when using the <em>relative frequencies</em>. See [1], section 17.1 for an introduction to ML parameter estimation. pgmpy supports MLE as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="n">mle</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;fruit&#39;</span><span class="p">))</span>  <span class="c1"># unconditional</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mle</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;tasty&#39;</span><span class="p">))</span>  <span class="c1"># conditional</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+---------------+-----+
| fruit(apple)  | 0.5 |
+---------------+-----+
| fruit(banana) | 0.5 |
+---------------+-----+
+------------+--------------+-----+---------------+
| fruit      | fruit(apple) | ... | fruit(banana) |
+------------+--------------+-----+---------------+
| size       | size(large)  | ... | size(small)   |
+------------+--------------+-----+---------------+
| tasty(no)  | 0.25         | ... | 1.0           |
+------------+--------------+-----+---------------+
| tasty(yes) | 0.75         | ... | 0.0           |
+------------+--------------+-----+---------------+
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">mle.estimate_cpd(variable)</span></code> computes the state counts and divides each cell by the (conditional) sample size. The <code class="docutils literal notranslate"><span class="pre">mle.get_parameters()</span></code>-method returns a list of CPDs for all variable of the model.</p>
<p>The built-in <code class="docutils literal notranslate"><span class="pre">fit()</span></code>-method of <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code> provides more convenient access to parameter estimators:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calibrate all CPDs of `model` using MLE:</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">MaximumLikelihoodEstimator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>While very straightforward, the ML estimator has the problem of <em>overfitting</em> to the data. In above CPD, the probability of a large banana being tasty is estimated at <code class="docutils literal notranslate"><span class="pre">0.833</span></code>, because <code class="docutils literal notranslate"><span class="pre">5</span></code> out of <code class="docutils literal notranslate"><span class="pre">6</span></code> observed large bananas were tasty. Fine. But note that the probability of a small banana being tasty is estimated at <code class="docutils literal notranslate"><span class="pre">0.0</span></code>, because we observed only one small banana and it happened to be not tasty. But that should hardly make us certain that small bananas aren’t tasty! We simply do not have
enough observations to rely on the observed frequencies. If the observed data is not representative for the underlying distribution, ML estimations will be extremly far off.</p>
<p>When estimating parameters for Bayesian networks, lack of data is a frequent problem. Even if the total sample size is very large, the fact that state counts are done conditionally for each parents configuration causes immense fragmentation. If a variable has 3 parents that can each take 10 states, then state counts will be done seperately for <code class="docutils literal notranslate"><span class="pre">10^3</span> <span class="pre">=</span> <span class="pre">1000</span></code> parents configurations. This makes MLE very fragile and unstable for learning Bayesian Network parameters. A way to mitigate MLE’s
overfitting is <em>Bayesian Parameter Estimation</em>.</p>
</section>
<section id="Bayesian-Parameter-Estimation">
<h3>Bayesian Parameter Estimation<a class="headerlink" href="#Bayesian-Parameter-Estimation" title="Permalink to this heading">¶</a></h3>
<p>The Bayesian Parameter Estimator starts with already existing prior CPDs, that express our beliefs about the variables <em>before</em> the data was observed. Those “priors” are then updated, using the state counts from the observed data. See [1], Section 17.3 for a general introduction to Bayesian estimators.</p>
<p>One can think of the priors as consisting in <em>pseudo state counts</em>, that are added to the actual counts before normalization. Unless one wants to encode specific beliefs about the distributions of the variables, one commonly chooses uniform priors, i.e. ones that deem all states equiprobable.</p>
<p>A very simple prior is the so-called <em>K2</em> prior, which simply adds <code class="docutils literal notranslate"><span class="pre">1</span></code> to the count of every single state. A somewhat more sensible choice of prior is <em>BDeu</em> (Bayesian Dirichlet equivalent uniform prior). For BDeu we need to specify an <em>equivalent sample size</em> <code class="docutils literal notranslate"><span class="pre">N</span></code> and then the pseudo-counts are the equivalent of having observed <code class="docutils literal notranslate"><span class="pre">N</span></code> uniform samples of each variable (and each parent configuration). In pgmpy:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">BayesianEstimator</span>
<span class="n">est</span> <span class="o">=</span> <span class="n">BayesianEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;tasty&#39;</span><span class="p">,</span> <span class="n">prior_type</span><span class="o">=</span><span class="s1">&#39;BDeu&#39;</span><span class="p">,</span> <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+------------+---------------------+-----+---------------------+
| fruit      | fruit(apple)        | ... | fruit(banana)       |
+------------+---------------------+-----+---------------------+
| size       | size(large)         | ... | size(small)         |
+------------+---------------------+-----+---------------------+
| tasty(no)  | 0.34615384615384615 | ... | 0.6428571428571429  |
+------------+---------------------+-----+---------------------+
| tasty(yes) | 0.6538461538461539  | ... | 0.35714285714285715 |
+------------+---------------------+-----+---------------------+
</pre></div></div>
</div>
<p>The estimated values in the CPDs are now more conservative. In particular, the estimate for a small banana being not tasty is now around <code class="docutils literal notranslate"><span class="pre">0.64</span></code> rather than <code class="docutils literal notranslate"><span class="pre">1.0</span></code>. Setting <code class="docutils literal notranslate"><span class="pre">equivalent_sample_size</span></code> to <code class="docutils literal notranslate"><span class="pre">10</span></code> means that for each parent configuration, we add the equivalent of 10 uniform samples (here: <code class="docutils literal notranslate"><span class="pre">+5</span></code> small bananas that are tasty and <code class="docutils literal notranslate"><span class="pre">+5</span></code> that aren’t).</p>
<p><code class="docutils literal notranslate"><span class="pre">BayesianEstimator</span></code>, too, can be used via the <code class="docutils literal notranslate"><span class="pre">fit()</span></code>-method. Full example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">BayesianEstimator</span>

<span class="c1"># generate data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)])</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">BayesianEstimator</span><span class="p">,</span> <span class="n">prior_type</span><span class="o">=</span><span class="s2">&quot;BDeu&quot;</span><span class="p">)</span> <span class="c1"># default equivalent_sample_size=5</span>
<span class="k">for</span> <span class="n">cpd</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cpd</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ankur/pgmpy_notebook/notebooks/pgmpy/models/BayesianModel.py:8: FutureWarning: BayesianModel has been renamed to BayesianNetwork. Please use BayesianNetwork class, BayesianModel will be removed in future.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+------+----------+
| A(0) | 0.511788 |
+------+----------+
| A(1) | 0.488212 |
+------+----------+
+------+---------------------+---------------------+
| A    | A(0)                | A(1)                |
+------+---------------------+---------------------+
| B(0) | 0.49199687682998244 | 0.5002046245140168  |
+------+---------------------+---------------------+
| B(1) | 0.5080031231700176  | 0.49979537548598324 |
+------+---------------------+---------------------+
+------+--------------------+-----+---------------------+
| A    | A(0)               | ... | A(1)                |
+------+--------------------+-----+---------------------+
| D    | D(0)               | ... | D(1)                |
+------+--------------------+-----+---------------------+
| C(0) | 0.4882005899705015 | ... | 0.5085907138474126  |
+------+--------------------+-----+---------------------+
| C(1) | 0.5117994100294986 | ... | 0.49140928615258744 |
+------+--------------------+-----+---------------------+
+------+--------------------+---------------------+
| B    | B(0)               | B(1)                |
+------+--------------------+---------------------+
| D(0) | 0.5120845921450151 | 0.48414271555996036 |
+------+--------------------+---------------------+
| D(1) | 0.4879154078549849 | 0.5158572844400396  |
+------+--------------------+---------------------+
</pre></div></div>
</div>
</section>
</section>
<section id="Structure-Learning">
<h2>Structure Learning<a class="headerlink" href="#Structure-Learning" title="Permalink to this heading">¶</a></h2>
<p>To learn model structure (a DAG) from a data set, there are two broad techniques:</p>
<ul class="simple">
<li><p>score-based structure learning</p></li>
<li><p>constraint-based structure learning</p></li>
</ul>
<p>The combination of both techniques allows further improvement: - hybrid structure learning</p>
<p>We briefly discuss all approaches and give examples.</p>
<p>This approach construes model selection as an optimization task. It has two building blocks:</p>
<ul class="simple">
<li><p>A <em>scoring function</em> <img class="math" src="../_images/math/aa63459009968b3faf2aa2f92426892298b69300.png" alt="s_D\colon M \to \mathbb R"/> that maps models to a numerical score, based on how well they fit to a given data set <img class="math" src="../_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/>.</p></li>
<li><p>A <em>search strategy</em> to traverse the search space of possible models <img class="math" src="../_images/math/4abba779877abb276b98ccb2b4ba9bf2e41947ab.png" alt="M"/> and select a model with optimal score.</p></li>
</ul>
<section id="Scoring-functions">
<h3>Scoring functions<a class="headerlink" href="#Scoring-functions" title="Permalink to this heading">¶</a></h3>
<p>Commonly used scores to measure the fit between model and data are <em>Bayesian Dirichlet scores</em> such as <em>BDeu</em> or <em>K2</em> and the <em>Bayesian Information Criterion</em> (BIC, also called MDL). See [1], Section 18.3 for a detailed introduction on scores. As before, BDeu is dependent on an equivalent sample size.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">BDeuScore</span><span class="p">,</span> <span class="n">K2Score</span><span class="p">,</span> <span class="n">BicScore</span>
<span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>

<span class="c1"># create random data sample with 3 variables, where Z is dependent on X, Y:</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;XY&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>

<span class="n">bdeu</span> <span class="o">=</span> <span class="n">BDeuScore</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="n">K2Score</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">bic</span> <span class="o">=</span> <span class="n">BicScore</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">model1</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)])</span>  <span class="c1"># X -&gt; Z &lt;- Y</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">)])</span>  <span class="c1"># Y &lt;- X -&gt; Z</span>


<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bic</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">k2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bic</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">model2</span><span class="p">))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-13938.353002020234
-14329.194269073454
-14294.390420213556
-20906.432489257266
-20933.26023936978
-20950.47339067585
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ankur/pgmpy_notebook/notebooks/pgmpy/models/BayesianModel.py:8: FutureWarning: BayesianModel has been renamed to BayesianNetwork. Please use BayesianNetwork class, BayesianModel will be removed in future.
  warnings.warn(
</pre></div></div>
</div>
<p>While the scores vary slightly, we can see that the correct <code class="docutils literal notranslate"><span class="pre">model1</span></code> has a much higher score than <code class="docutils literal notranslate"><span class="pre">model2</span></code>. Importantly, these scores <em>decompose</em>, i.e. they can be computed locally for each of the variables given their potential parents, independent of other parts of the network:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">local_score</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="p">[]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">local_score</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bdeu</span><span class="o">.</span><span class="n">local_score</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-9282.88160824462
-6993.603560250576
-57.1217389219957
</pre></div></div>
</div>
</section>
<section id="Search-strategies">
<h3>Search strategies<a class="headerlink" href="#Search-strategies" title="Permalink to this heading">¶</a></h3>
<p>The search space of DAGs is super-exponential in the number of variables and the above scoring functions allow for local maxima. The first property makes exhaustive search intractable for all but very small networks, the second prohibits efficient local optimization algorithms to always find the optimal structure. Thus, identifiying the ideal structure is often not tractable. Despite these bad news, heuristic search strategies often yields good results.</p>
<p>If only few nodes are involved (read: less than 5), <code class="docutils literal notranslate"><span class="pre">ExhaustiveSearch</span></code> can be used to compute the score for every DAG and returns the best-scoring one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">ExhaustiveSearch</span>

<span class="n">es</span> <span class="o">=</span> <span class="n">ExhaustiveSearch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="n">bic</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">All DAGs by score:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">score</span><span class="p">,</span> <span class="n">dag</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">es</span><span class="o">.</span><span class="n">all_scores</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">dag</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;)]

All DAGs by score:
-14294.390420213556 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;)]
-14330.086974085189 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;)]
-14330.086974085189 [(&#39;X&#39;, &#39;Y&#39;), (&#39;X&#39;, &#39;Z&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-14330.08697408519 [(&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-14330.08697408519 [(&#39;Y&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-14330.08697408519 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Z&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-14330.08697408519 [(&#39;X&#39;, &#39;Y&#39;), (&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;Z&#39;)]
-16586.926723773093 [(&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-16587.66791728165 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-18657.937087116316 [(&#39;Z&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-18657.937087116316 [(&#39;Y&#39;, &#39;Z&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-18657.937087116316 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-20914.776836804216 [(&#39;Z&#39;, &#39;X&#39;)]
-20914.776836804216 [(&#39;X&#39;, &#39;Z&#39;)]
-20915.518030312778 [(&#39;Z&#39;, &#39;Y&#39;)]
-20915.518030312778 [(&#39;Y&#39;, &#39;Z&#39;)]
-20950.47339067585 [(&#39;X&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;)]
-20950.47339067585 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Z&#39;, &#39;X&#39;)]
-20950.47339067585 [(&#39;X&#39;, &#39;Y&#39;), (&#39;X&#39;, &#39;Z&#39;)]
-20951.21458418441 [(&#39;Y&#39;, &#39;X&#39;), (&#39;Z&#39;, &#39;Y&#39;)]
-20951.21458418441 [(&#39;Y&#39;, &#39;Z&#39;), (&#39;Y&#39;, &#39;X&#39;)]
-20951.21458418441 [(&#39;X&#39;, &#39;Y&#39;), (&#39;Y&#39;, &#39;Z&#39;)]
-23172.357780000675 []
-23208.05433387231 [(&#39;Y&#39;, &#39;X&#39;)]
-23208.05433387231 [(&#39;X&#39;, &#39;Y&#39;)]
</pre></div></div>
</div>
<p>Once more nodes are involved, one needs to switch to heuristic search. <code class="docutils literal notranslate"><span class="pre">HillClimbSearch</span></code> implements a greedy local search that starts from the DAG <code class="docutils literal notranslate"><span class="pre">start</span></code> (default: disconnected DAG) and proceeds by iteratively performing single-edge manipulations that maximally increase the score. The search terminates once a local maximum is found.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">HillClimbSearch</span>

<span class="c1"># create some data with dependencies</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="n">hc</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="n">BicScore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1f781a2436e4066ab8e015257068eb8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;A&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;)]
</pre></div></div>
</div>
<p>The search correctly identifies e.g. that <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> do not influnce <code class="docutils literal notranslate"><span class="pre">H</span></code> directly, only through <code class="docutils literal notranslate"><span class="pre">A</span></code> and of course that <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">E</span></code>, <code class="docutils literal notranslate"><span class="pre">F</span></code> are independent.</p>
<p>To enforce a wider exploration of the search space, the search can be enhanced with a tabu list. The list keeps track of the last <code class="docutils literal notranslate"><span class="pre">n</span></code> modfications; those are then not allowed to be reversed, regardless of the score. Additionally a <code class="docutils literal notranslate"><span class="pre">white_list</span></code> or <code class="docutils literal notranslate"><span class="pre">black_list</span></code> can be supplied to restrict the search to a particular subset or to exclude certain edges. The parameter <code class="docutils literal notranslate"><span class="pre">max_indegree</span></code> allows to restrict the maximum number of parents for each node.</p>
<section id="Constraint-based-Structure-Learning">
<h4>Constraint-based Structure Learning<a class="headerlink" href="#Constraint-based-Structure-Learning" title="Permalink to this heading">¶</a></h4>
<p>A different, but quite straightforward approach to build a DAG from data is this:</p>
<ol class="arabic simple">
<li><p>Identify independencies in the data set using hypothesis tests</p></li>
<li><p>Construct DAG (pattern) according to identified independencies</p></li>
</ol>
</section>
</section>
<section id="(Conditional)-Independence-Tests">
<h3>(Conditional) Independence Tests<a class="headerlink" href="#(Conditional)-Independence-Tests" title="Permalink to this heading">¶</a></h3>
<p>Independencies in the data can be identified using chi2 conditional independence tests. To this end, a conditional independence hypothesis test is performed to check if <code class="docutils literal notranslate"><span class="pre">X</span></code> is independent from <code class="docutils literal notranslate"><span class="pre">Y</span></code> given a set of variables <code class="docutils literal notranslate"><span class="pre">Zs</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators.CITests</span> <span class="kn">import</span> <span class="n">chi_square</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>          <span class="c1"># dependent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>          <span class="c1"># independent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>       <span class="c1"># independent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>          <span class="c1"># independent</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi_square</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>       <span class="c1"># dependent</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
True
True
True
False
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">CITests.py</span></code> module in pgmpy implements a few possible conditional independence tests.</p>
</section>
<section id="DAG-(pattern)-construction">
<h3>DAG (pattern) construction<a class="headerlink" href="#DAG-(pattern)-construction" title="Permalink to this heading">¶</a></h3>
<p>With a method for independence testing at hand, we can construct a DAG from the data set in three steps: 1. Construct an undirected skeleton - <code class="docutils literal notranslate"><span class="pre">estimate_skeleton()</span></code> 2. Orient compelled edges to obtain partially directed acyclid graph (PDAG; I-equivalence class of DAGs) - <code class="docutils literal notranslate"><span class="pre">skeleton_to_pdag()</span></code> 3. Extend DAG pattern to a DAG by conservatively orienting the remaining edges in some way - <code class="docutils literal notranslate"><span class="pre">pdag_to_dag()</span></code></p>
<p>Step 1.&amp;2. form the so-called PC algorithm, see [2], page 550. PDAGs are <code class="docutils literal notranslate"><span class="pre">DirectedGraph</span></code>s, that may contain both-way edges, to indicate that the orientation for the edge is not determined.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">skel</span><span class="p">,</span> <span class="n">seperating_sets</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">significance_level</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Undirected edges: &quot;</span><span class="p">,</span> <span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="n">pdag</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">skeleton_to_pdag</span><span class="p">(</span><span class="n">skel</span><span class="p">,</span> <span class="n">seperating_sets</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PDAG edges:       &quot;</span><span class="p">,</span> <span class="n">pdag</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">pdag</span><span class="o">.</span><span class="n">to_dag</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DAG edges:        &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3a282f0a828a4d2a8fc995b9f57204ef", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Undirected edges:  [(&#39;A&#39;, &#39;B&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;H&#39;), (&#39;E&#39;, &#39;F&#39;), (&#39;G&#39;, &#39;H&#39;)]
PDAG edges:        [(&#39;A&#39;, &#39;H&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;E&#39;, &#39;F&#39;), (&#39;F&#39;, &#39;E&#39;)]
DAG edges:         [(&#39;A&#39;, &#39;H&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;E&#39;, &#39;F&#39;)]
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">estimate()</span></code>-method provides a shorthand for the three steps above and directly returns a <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">significance_level</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ce622083c1f46fbba5a4f0444935739", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;A&#39;, &#39;H&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;G&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;E&#39;, &#39;F&#39;)]
</pre></div></div>
</div>
<p>PC PDAG construction is only guaranteed to work under the assumption that the identified set of independencies is <em>faithful</em>, i.e. there exists a DAG that exactly corresponds to it. Spurious dependencies in the data set can cause the reported independencies to violate faithfulness. It can happen that the estimated PDAG does not have any faithful completions (i.e. edge orientations that do not introduce new v-structures). In that case a warning is issued.</p>
<section id="Hybrid-Structure-Learning">
<h4>Hybrid Structure Learning<a class="headerlink" href="#Hybrid-Structure-Learning" title="Permalink to this heading">¶</a></h4>
<p>The MMHC algorithm [3] combines the constraint-based and score-based method. It has two parts:</p>
<ol class="arabic simple">
<li><p>Learn undirected graph skeleton using the constraint-based construction procedure MMPC</p></li>
<li><p>Orient edges using score-based optimization (BDeu score + modified hill-climbing)</p></li>
</ol>
<p>We can perform the two steps seperately, more or less as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">MmhcEstimator</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">BDeuScore</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGH&#39;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>

<span class="n">mmhc</span> <span class="o">=</span> <span class="n">MmhcEstimator</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">skeleton</span> <span class="o">=</span> <span class="n">mmhc</span><span class="o">.</span><span class="n">mmpc</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 1) Skeleton: &quot;</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="c1"># use hill climb search to orient the edges:</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">tabu_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">white_list</span><span class="o">=</span><span class="n">skeleton</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">(),</span> <span class="n">scoring_method</span><span class="o">=</span><span class="n">BDeuScore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 2) Model:    &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part 1) Skeleton:  [(&#39;A&#39;, &#39;B&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;H&#39;), (&#39;A&#39;, &#39;E&#39;), (&#39;A&#39;, &#39;G&#39;), (&#39;B&#39;, &#39;E&#39;), (&#39;C&#39;, &#39;G&#39;), (&#39;C&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;F&#39;), (&#39;E&#39;, &#39;F&#39;), (&#39;E&#39;, &#39;H&#39;), (&#39;F&#39;, &#39;G&#39;), (&#39;G&#39;, &#39;H&#39;)]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "29a61574918e4004a7d1b7a76a3b3b2d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part 2) Model:     [(&#39;A&#39;, &#39;H&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;C&#39;, &#39;A&#39;), (&#39;F&#39;, &#39;E&#39;), (&#39;G&#39;, &#39;H&#39;)]
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MmhcEstimator.estimate()</span></code> is a shorthand for both steps and directly estimates a <code class="docutils literal notranslate"><span class="pre">BayesianModel</span></code>.</p>
</section>
<section id="Conclusion">
<h4>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this heading">¶</a></h4>
<p>This notebook aimed to give an overview of pgmpy’s estimators for learning Bayesian network structure and parameters. For more information about the individual functions see their docstring documentation. If you used pgmpy’s structure learning features to satisfactorily learn a non-trivial network from real data, feel free to drop us an eMail via the mailing list or just open a Github issue. We’d like to put your network in the examples-section!</p>
</section>
<section id="References">
<h4>References<a class="headerlink" href="#References" title="Permalink to this heading">¶</a></h4>
<p>[1] Koller &amp; Friedman, Probabilistic Graphical Models - Principles and Techniques, 2009</p>
<p>[2] Neapolitan, <a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">Learning Bayesian Networks</a>, 2003</p>
<p>[3] Tsamardinos et al., <a class="reference external" href="http://www.dsl-lab.org/supplements/mmhc_paper/paper_online.pdf">The max-min hill-climbing BN structure learning algorithm</a>, 2005</p>
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../started/base.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base/base.html">Base Model Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/base.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../factors/base.html">Parameterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exact_infer/base.html">Exact Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exact_infer/model_testing.html">Model Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../approx_infer/base.html">Approximate Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../param_estimator/base.html">Parameter Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure_estimator/base.html">Structure Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metrics for testing models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readwrite/base.html">Reading/Writing to File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Example Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1.%20Introduction%20to%20Probabilistic%20Graphical%20Models.html">Introduction to Probabilitic Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.%20Bayesian%20Networks.html">Bayesian Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.%20Causal%20Bayesian%20Networks.html">Causal Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.%20Markov%20Models.html">Markov Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.%20Exact%20Inference%20in%20Graphical%20Models.html">Exact Inference in Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.%20Approximate%20Inference%20in%20Graphical%20Models.html">Approximate Inference in Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.%20Parameterizing%20with%20Continuous%20Variables.html">Parameterizing with Continuous Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="8.%20Sampling%20Algorithms.html">Sampling In Continuous Graphical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html">Reading and Writing from pgmpy file formats</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Learning Bayesian Networks from Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html">A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../tutorial.html">Tutorial Notebooks</a><ul>
      <li>Previous: <a href="9.%20Reading%20and%20Writing%20from%20pgmpy%20file%20formats.html" title="previous chapter">Reading and Writing from pgmpy file formats</a></li>
      <li>Next: <a href="11.%20A%20Bayesian%20Network%20to%20model%20the%20influence%20of%20energy%20consumption%20on%20greenhouse%20gases%20in%20Italy.html" title="next chapter">A Bayesian Network to model the influence of energy consumption on greenhouse gases in Italy</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>







<script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>

<div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="horizontal"></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HCFR07M31W');
</script>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Ankur Ankan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/detailed_notebooks/10. Learning Bayesian Networks from Data.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>