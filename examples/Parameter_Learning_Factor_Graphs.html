<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Marginal Learning in Discrete Markov Networks" />
<meta property="og:type" content="website" />
<meta property="og:url" content="examples/Parameter_Learning_Factor_Graphs.html" />
<meta property="og:site_name" content="pgmpy" />
<meta property="og:description" content="In this notebook, we show an example for learning the parameters (potentials) of a Factor Graph or Markov Network given the data and its corresponding marginals. In the examples, we will generate s..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="_images/social_previews/summary_examples_Parameter_Learning_Factor_Graphs_50e46ac7.png" />
<meta property="og:image:alt" content="In this notebook, we show an example for learning the parameters (potentials) of a Factor Graph or Markov Network given the data and its corresponding marginals. In the examples, we will generate s..." />
<meta name="description" content="In this notebook, we show an example for learning the parameters (potentials) of a Factor Graph or Markov Network given the data and its corresponding marginals. In the examples, we will generate s..." />
<meta name="twitter:card" content="summary_large_image" />

    <title>Marginal Learning in Discrete Markov Networks &#8212; 1.0.0 | pgmpy docs</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=7b53859b" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://pgmpy.org/examples/Parameter_Learning_Factor_Graphs.html" />
    <link rel="icon" href="../_static/logo_favi.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Inference in Discrete Bayesian Network" href="Inference_Discrete_BN.html" />
    <link rel="prev" title="Parameter Learning in Discrete Bayesian Networks" href="Parameter_Learning_Discrete_BN.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Marginal-Learning-in-Discrete-Markov-Networks">
<h1>Marginal Learning in Discrete Markov Networks<a class="headerlink" href="#Marginal-Learning-in-Discrete-Markov-Networks" title="Link to this heading">¶</a></h1>
<p>In this notebook, we show an example for learning the parameters (potentials) of a Factor Graph or Markov Network given the data and its corresponding marginals.</p>
<p>In the examples, we will generate some data from given models and perform out of clique inference for certain queries.</p>
<section id="Modeling-who-wins-a-Football-game">
<h2>Modeling who wins a Football game<a class="headerlink" href="#Modeling-who-wins-a-Football-game" title="Link to this heading">¶</a></h2>
<p>Model who wins a football game just based off who won each game of the season.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">FactorGraph</span><span class="p">,</span> <span class="n">JunctionTree</span>
<span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">DiscreteFactor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators.MLE</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">MirrorDescentEstimator</span>
<span class="kn">from</span> <span class="nn">pgmpy.inference.ExactInference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="kn">from</span> <span class="nn">pgmpy.factors</span> <span class="kn">import</span> <span class="n">FactorDict</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
<section id="Step-1:-Load-the-games-data-and-form-a-FactorGraph">
<h3>Step 1: Load the <code class="docutils literal notranslate"><span class="pre">games</span></code> data and form a <code class="docutils literal notranslate"><span class="pre">FactorGraph</span></code><a class="headerlink" href="#Step-1:-Load-the-games-data-and-form-a-FactorGraph" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">games</span></code> has the results of the 2023-2024 NFL season including the playoffs, but excluding the Super Bowl.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">games</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;examples/data/games.csv&quot;</span><span class="p">)</span>
<span class="c1"># Define a &quot;win&quot; to include ties for the home team.</span>
<span class="n">games</span><span class="p">[</span><span class="s2">&quot;homeWin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">games</span><span class="o">.</span><span class="n">homeFinalScore</span> <span class="o">&gt;=</span> <span class="n">games</span><span class="o">.</span><span class="n">visitorFinalScore</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;win&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="s2">&quot;loss&quot;</span>
<span class="p">)</span>
<span class="n">TEAMS</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">games</span><span class="o">.</span><span class="n">homeTeamAbbr</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">games</span><span class="o">.</span><span class="n">visitorTeamAbbr</span><span class="p">)))</span>
<span class="n">COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">,</span> <span class="s2">&quot;homeWin&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">games</span><span class="p">[</span><span class="n">COLUMNS</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>homeTeamAbbr</th>
      <th>visitorTeamAbbr</th>
      <th>homeWin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NYG</td>
      <td>DAL</td>
      <td>loss</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NYJ</td>
      <td>BUF</td>
      <td>win</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NE</td>
      <td>PHI</td>
      <td>loss</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BAL</td>
      <td>HOU</td>
      <td>win</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MIN</td>
      <td>TB</td>
      <td>loss</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">FactorGraph</span><span class="p">()</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">COLUMNS</span>
<span class="c1"># Map of variables to all possible states.</span>
<span class="n">state_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">:</span> <span class="n">TEAMS</span><span class="p">,</span>
    <span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">:</span> <span class="n">TEAMS</span><span class="p">,</span>
    <span class="s2">&quot;homeWin&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="s2">&quot;win&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">cardinalities</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;homeWin&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="c1"># Form factors with all possible combinations of columns. Initialize each</span>
<span class="c1"># factor with zeros.</span>
<span class="n">factors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">DiscreteFactor</span><span class="p">(</span>
        <span class="n">variables</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
        <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="n">cardinalities</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">],</span>
        <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">cardinalities</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">)),</span>
        <span class="n">state_names</span><span class="o">=</span><span class="n">state_names</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Model one-way, two-way, &amp; three-way marginals.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">COLUMNS</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">]</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="o">*</span><span class="n">factors</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span>
    <span class="p">[(</span><span class="n">node</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">factors</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">factor</span><span class="o">.</span><span class="n">scope</span><span class="p">()]</span>
<span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the structure of the Graph to verify its correctness.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">top</span> <span class="o">=</span> <span class="p">{</span><span class="n">team</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">team</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">nodes</span><span class="p">))}</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="p">{</span><span class="n">factor</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">factor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">factors</span><span class="p">)}</span>
<span class="c1"># Draw all the variables &amp; factors with their edges.</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
    <span class="n">G</span><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">top</span><span class="p">,</span> <span class="o">**</span><span class="n">bottom</span><span class="p">},</span>
    <span class="n">edge_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Draw text labels for the factors above their nodes in the graph.</span>
<span class="n">label_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">factor</span><span class="p">:</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">factor</span><span class="o">.</span><span class="n">scope</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">factors</span><span class="p">}</span>
<span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">bottom</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">label_dict</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="c1"># Re-draw the variables but with labels this time and colored orange.</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
    <span class="n">G</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span>
    <span class="n">node_color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">top</span><span class="p">},</span>
    <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/examples_Parameter_Learning_Factor_Graphs_7_0.png" src="../../../pgmpy_docs/doctrees/nbsphinx/examples_Parameter_Learning_Factor_Graphs_7_0.png" />
</div>
</div>
</section>
<section id="Step-2:-Define-a-model-using-MaximumLikelihoodEstimator">
<h3>Step 2: Define a model using <code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodEstimator</span></code><a class="headerlink" href="#Step-2:-Define-a-model-using-MaximumLikelihoodEstimator" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize model</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">to_junction_tree</span><span class="p">(),</span> <span class="n">data</span><span class="o">=</span><span class="n">games</span><span class="p">)</span>
<span class="n">marginals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">scope</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">factors</span><span class="p">]</span>
<span class="n">observed_factor_dict</span> <span class="o">=</span> <span class="n">FactorDict</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">games</span><span class="p">,</span> <span class="n">marginals</span><span class="o">=</span><span class="n">marginals</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-3:-Learn-the-marginals">
<h3>Step 3: Learn the marginals<a class="headerlink" href="#Step-3:-Learn-the-marginals" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">model</span>
<span class="n">tree</span><span class="o">.</span><span class="n">clique_beliefs</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
<span class="n">modeled_factor</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">factors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-4:-View-the-true-marginals-against-estimated-marginals">
<h3>Step 4: View the true marginals against estimated marginals<a class="headerlink" href="#Step-4:-View-the-true-marginals-against-estimated-marginals" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare a larger clique against the true marginals.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">visitorTeamAbbr_marginal</span> <span class="o">=</span> <span class="n">observed_factor_dict</span><span class="p">[(</span><span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">,)]</span>
<span class="n">total_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">visitorTeamAbbr_marginal</span><span class="o">.</span><span class="n">cardinality</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="n">total_states</span><span class="p">),</span>
    <span class="n">visitorTeamAbbr_marginal</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Observed Marginals&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="n">total_states</span><span class="p">),</span>
    <span class="n">modeled_factor</span><span class="o">.</span><span class="n">marginalize</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">,</span> <span class="s2">&quot;homeWin&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Estimated Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/examples_Parameter_Learning_Factor_Graphs_13_0.png" src="../../../pgmpy_docs/doctrees/nbsphinx/examples_Parameter_Learning_Factor_Graphs_13_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="Modeling-the-home-&amp;-visitor-scores">
<h1>Modeling the home &amp; visitor scores<a class="headerlink" href="#Modeling-the-home-&-visitor-scores" title="Link to this heading">¶</a></h1>
<p>Now, we add back in the score for the home and visitor teams.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">COLUMNS_2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">,</span> <span class="s2">&quot;homeFinalScore&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorFinalScore&quot;</span><span class="p">]</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">games</span><span class="p">[</span><span class="n">COLUMNS_2</span><span class="p">]</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>homeTeamAbbr</th>
      <th>visitorTeamAbbr</th>
      <th>homeFinalScore</th>
      <th>visitorFinalScore</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NYG</td>
      <td>DAL</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NYJ</td>
      <td>BUF</td>
      <td>22</td>
      <td>16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NE</td>
      <td>PHI</td>
      <td>20</td>
      <td>25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BAL</td>
      <td>HOU</td>
      <td>25</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MIN</td>
      <td>TB</td>
      <td>17</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This time, more marginals are possible.</span>
<span class="n">marginals_2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
    <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
        <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">COLUMNS_2</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">marginals_2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;homeTeamAbbr&#39;,),
 (&#39;visitorTeamAbbr&#39;,),
 (&#39;homeFinalScore&#39;,),
 (&#39;visitorFinalScore&#39;,),
 (&#39;homeTeamAbbr&#39;, &#39;visitorTeamAbbr&#39;),
 (&#39;homeTeamAbbr&#39;, &#39;homeFinalScore&#39;),
 (&#39;homeTeamAbbr&#39;, &#39;visitorFinalScore&#39;),
 (&#39;visitorTeamAbbr&#39;, &#39;homeFinalScore&#39;),
 (&#39;visitorTeamAbbr&#39;, &#39;visitorFinalScore&#39;),
 (&#39;homeFinalScore&#39;, &#39;visitorFinalScore&#39;),
 (&#39;homeTeamAbbr&#39;, &#39;visitorTeamAbbr&#39;, &#39;homeFinalScore&#39;),
 (&#39;homeTeamAbbr&#39;, &#39;visitorTeamAbbr&#39;, &#39;visitorFinalScore&#39;),
 (&#39;homeTeamAbbr&#39;, &#39;homeFinalScore&#39;, &#39;visitorFinalScore&#39;),
 (&#39;visitorTeamAbbr&#39;, &#39;homeFinalScore&#39;, &#39;visitorFinalScore&#39;),
 (&#39;homeTeamAbbr&#39;, &#39;visitorTeamAbbr&#39;, &#39;homeFinalScore&#39;, &#39;visitorFinalScore&#39;)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instead of creating our graph from every possible combination, we can build</span>
<span class="c1"># directly from the dataframe, and then setting each factor equal to 0.0.</span>
<span class="n">G_2</span> <span class="o">=</span> <span class="n">JunctionTree</span><span class="p">()</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">COLUMNS_2</span>
<span class="n">observed_factor_dict</span> <span class="o">=</span> <span class="n">FactorDict</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span>
    <span class="n">games</span><span class="p">,</span>
    <span class="n">marginals</span><span class="o">=</span><span class="n">marginals_2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">factors_2</span> <span class="o">=</span> <span class="n">observed_factor_dict</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">i</span><span class="o">.</span><span class="n">identity_factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">observed_factor_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">]</span>
<span class="n">G_2</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="n">COLUMNS_2</span><span class="p">)</span>
<span class="n">G_2</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="n">factors_2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">G_2</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We have a single clique, including all of the dataframe&#39;s columns.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">G_2</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">G_2</span><span class="o">.</span><span class="n">factors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;homeTeamAbbr&#39;, &#39;visitorTeamAbbr&#39;, &#39;homeFinalScore&#39;, &#39;visitorFinalScore&#39;)]
[&lt;DiscreteFactor representing phi(homeTeamAbbr:32, visitorTeamAbbr:32, homeFinalScore:45, visitorFinalScore:40) at 0x32d593ee0&gt;]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the new estimation.</span>
<span class="n">estimator_2</span> <span class="o">=</span> <span class="n">MirrorDescentEstimator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">G_2</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">games</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">estimator_2</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span>
    <span class="n">marginals</span><span class="o">=</span><span class="n">marginals_2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;L2&quot;</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">600</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1f567699bef44f0897bc0e8e3468b7a0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 1min 23s, sys: 1min 21s, total: 2min 44s
Wall time: 2min 48s
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree_2</span> <span class="o">=</span> <span class="n">estimator_2</span><span class="o">.</span><span class="n">belief_propagation</span><span class="o">.</span><span class="n">junction_tree</span>
<span class="n">modeled_factor_2</span> <span class="o">=</span> <span class="n">tree_2</span><span class="o">.</span><span class="n">factors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inference for a hypothetical game.</span>
<span class="n">sf_kc</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;homeFinalScore&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorFinalScore&quot;</span><span class="p">],</span>
    <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">:</span> <span class="s2">&quot;KC&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">:</span> <span class="s2">&quot;SF&quot;</span><span class="p">},</span>
    <span class="n">joint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">kc_sf</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;homeFinalScore&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorFinalScore&quot;</span><span class="p">],</span>
    <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;homeTeamAbbr&quot;</span><span class="p">:</span> <span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;visitorTeamAbbr&quot;</span><span class="p">:</span> <span class="s2">&quot;KC&quot;</span><span class="p">},</span>
    <span class="n">joint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sf_kc</span><span class="p">,</span> <span class="n">DiscreteFactor</span><span class="p">)</span>
<span class="n">sf_kc_sample</span> <span class="o">=</span> <span class="n">sf_kc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1_000_000</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kc_sf</span><span class="p">,</span> <span class="n">DiscreteFactor</span><span class="p">)</span>
<span class="n">kc_sf_sample</span> <span class="o">=</span> <span class="n">kc_sf</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1_000_000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sf_kc_diff</span> <span class="o">=</span> <span class="n">sf_kc_sample</span><span class="o">.</span><span class="n">homeFinalScore</span> <span class="o">-</span> <span class="n">sf_kc_sample</span><span class="o">.</span><span class="n">visitorFinalScore</span>
<span class="n">sf_kc_diff</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;KC (Home) - SF (Away), bins=30 AVG=</span><span class="si">{</span><span class="n">sf_kc_diff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">kc_sf_diff</span> <span class="o">=</span> <span class="n">kc_sf_sample</span><span class="o">.</span><span class="n">homeFinalScore</span> <span class="o">-</span> <span class="n">kc_sf_sample</span><span class="o">.</span><span class="n">visitorFinalScore</span>
<span class="n">kc_sf_diff</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SF (Home) - KC (Away), bins=30 AVG=</span><span class="si">{</span><span class="n">kc_sf_diff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Score Difference of Super Bowl LVIII&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../pgmpy_docs/doctrees/nbsphinx/examples_Parameter_Learning_Factor_Graphs_28_0.png" src="../../../pgmpy_docs/doctrees/nbsphinx/examples_Parameter_Learning_Factor_Graphs_28_0.png" />
</div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
  </a>
</p>









<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../started/base.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples.html#defining-bayesian-networks">Defining Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#causal-discovery-structure-learning">Causal Discovery / Structure Learning</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#parameter-estimation">Parameter Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#probabilistic-inference">Probabilistic Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#causal-inference">Causal Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#simulations">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#extending-pgmpy">Extending pgmpy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/base.html">Supported Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../factors/base.html">Parameterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/base.html">Probabilistic Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../causal_infer/base.html">Causal Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../param_estimator/base.html">Parameter Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure_estimator/base.html">Causal Discovery / Structure Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metrics for Testing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readwrite/base.html">Reading/Writing to File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial Notebooks</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../examples.html">Examples</a><ul>
      <li>Previous: <a href="Parameter_Learning_Discrete_BN.html" title="previous chapter">Parameter Learning in Discrete Bayesian Networks</a></li>
      <li>Next: <a href="Inference_Discrete_BN.html" title="next chapter">Inference in Discrete Bayesian Network</a></li>
  </ul></li>
  </ul></li>
</ul>
</div><script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>

<div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="horizontal"></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HCFR07M31W');
</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Ankur Ankan.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/examples/Parameter_Learning_Factor_Graphs.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>