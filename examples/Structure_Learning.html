<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Structure Learning in Bayesian Networks" />
<meta property="og:type" content="website" />
<meta property="og:url" content="examples/Structure_Learning.html" />
<meta property="og:site_name" content="pgmpy" />
<meta property="og:description" content="In this notebook, we show a few examples of Causal Discovery or Structure Learning in pgmpy. pgmpy currently has the following algorithm for causal discovery: PC: Has 3 variants original, stable, a..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="_images/social_previews/summary_examples_Structure_Learning_852a27ab.png" />
<meta property="og:image:alt" content="In this notebook, we show a few examples of Causal Discovery or Structure Learning in pgmpy. pgmpy currently has the following algorithm for causal discovery: PC: Has 3 variants original, stable, a..." />
<meta name="description" content="In this notebook, we show a few examples of Causal Discovery or Structure Learning in pgmpy. pgmpy currently has the following algorithm for causal discovery: PC: Has 3 variants original, stable, a..." />
<meta name="twitter:card" content="summary_large_image" />

    <title>Structure Learning in Bayesian Networks &#8212; 1.0.0 | pgmpy docs</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=7b53859b" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://pgmpy.org/examples/Structure_Learning.html" />
    <link rel="icon" href="../_static/logo_favi.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Learning Tree Structure from Data using the Chow-Liu Algorithm" href="Structure_Learning_Chow_Liu.html" />
    <link rel="prev" title="Basic Operations on Bayesian Networks" href="Basic_Operations_on_BN.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Structure-Learning-in-Bayesian-Networks">
<h1>Structure Learning in Bayesian Networks<a class="headerlink" href="#Structure-Learning-in-Bayesian-Networks" title="Link to this heading">¶</a></h1>
<p>In this notebook, we show a few examples of Causal Discovery or Structure Learning in pgmpy. pgmpy currently has the following algorithm for causal discovery:</p>
<ol class="arabic simple">
<li><p><strong>PC</strong>: Has <img class="math" src="../_images/math/3204f0580808cc1d3ded72d87384c025c9e7e272.png" alt="3"/> variants original, stable, and parallel. PC is a constraint-based algorithm that utilizes Conditional Independence tests to construct the model.</p></li>
<li><p><strong>Hill-Climb Search</strong>: Hill-Climb Search is a greedy optimization-based algorithm that makes iterative local changes to the model structure such that it improves the overall score of the model.</p></li>
<li><p><strong>Greedy Equivalence Search (GES)</strong>: Another score-based method that makes greedy modifications to the model to improve its score iteratively.</p></li>
<li><p><strong>ExpertInLoop</strong>: An iterative algorithm that combines Conditional Independence testing with expert knowledge. The user or an LLM can act as the expert.</p></li>
<li><p><strong>Exhaustive Search</strong>: Exhaustive search iterates over all possible network structures on the given variables to find the most optimal one. As it tries to enumerate all possible network structures, it is intractable when the number of variables in the data is large.</p></li>
</ol>
<p>The following Conditional Independence Tests are available to use with PC algorithm. 1. <strong>Discrete Data</strong>: When all variables are discrete/categorical. 1. <strong>Chi-square test</strong>: <code class="docutils literal notranslate"><span class="pre">ci_test=&quot;chi_square&quot;</span></code> 2. <strong>G-squared</strong>: <code class="docutils literal notranslate"><span class="pre">ci_test=&quot;g_sq&quot;</span></code> 3. <strong>Log-likelihood</strong>: Is equivalent to G-squared test. <code class="docutils literal notranslate"><span class="pre">ci_test=&quot;log_likelihood</span></code> 2. <strong>Continuous Data</strong>: When all variables are continuous/numerical. 1. <strong>Partial Correlation</strong>: <code class="docutils literal notranslate"><span class="pre">ci_test=&quot;pearsonr&quot;</span></code> 3. <strong>Mixed Data</strong>: When there is a mix of categorical and
continuous variables. 1. <strong>Pillai</strong>: <code class="docutils literal notranslate"><span class="pre">ci_test=&quot;pillai&quot;</span></code></p>
<p>For Hill-Climb, Exhausitive Search, and GES the following scoring methods can be used: 1. <strong>Discrete Data</strong>: When all variables are discrete/categorical. 1. <strong>BIC Score</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;bic-d&quot;</span></code> 2. <strong>AIC Score</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;aic-d&quot;</span></code> 3. <strong>K2 Score</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;k2&quot;</span></code> 4. <strong>BDeU Score</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;bdeu&quot;</span></code> 5. <strong>BDs Score</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;bds&quot;</span></code> 2. <strong>Continuous Data</strong>: When all variables are continuous/numerical. 1. <strong>Log-Likelihood</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;ll-g&quot;</span></code> 2.
<strong>AIC</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;aic-g&quot;</span></code> 3. <strong>BIC</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;bic-g&quot;</span></code> 3. <strong>Mixed Data</strong>: When there is a mix of discrete and continuous variables. 1. <strong>AIC</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;aic-cg&quot;</span></code> 2. <strong>BIC</strong>: <code class="docutils literal notranslate"><span class="pre">scoring_method=&quot;bic-cg&quot;</span></code></p>
<section id="0.-Simulate-some-sample-datasets">
<h2>0. Simulate some sample datasets<a class="headerlink" href="#0.-Simulate-some-sample-datasets" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>

<span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">PC</span><span class="p">,</span> <span class="n">HillClimbSearch</span><span class="p">,</span> <span class="n">GES</span>
<span class="kn">from</span> <span class="nn">pgmpy.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="kn">from</span> <span class="nn">pgmpy.metrics</span> <span class="kn">import</span> <span class="n">SHD</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Discrete variable dataset</span>
<span class="n">alarm_model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="n">alarm_samples</span> <span class="o">=</span> <span class="n">alarm_model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">))</span>
<span class="n">alarm_samples</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># Continuous variable dataset</span>
<span class="n">ecoli_model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;ecoli70&quot;</span><span class="p">)</span>
<span class="n">ecoli_samples</span> <span class="o">=</span> <span class="n">ecoli_model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e3</span><span class="p">))</span>
<span class="n">ecoli_samples</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aa35b1a7897646d7ac141e27e04a6165", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:pgmpy:Probability values don&#39;t exactly sum to 1. Differ by: -2.220446049250313e-16. Adjusting values.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b1191</th>
      <th>cspG</th>
      <th>eutG</th>
      <th>fixC</th>
      <th>cspA</th>
      <th>yecO</th>
      <th>yedE</th>
      <th>sucA</th>
      <th>cchB</th>
      <th>yceP</th>
      <th>...</th>
      <th>dnaK</th>
      <th>folK</th>
      <th>ycgX</th>
      <th>lacZ</th>
      <th>nuoM</th>
      <th>dnaG</th>
      <th>b1583</th>
      <th>mopB</th>
      <th>yaeM</th>
      <th>ftsJ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.060641</td>
      <td>2.044477</td>
      <td>0.341216</td>
      <td>1.448399</td>
      <td>-0.351716</td>
      <td>2.189750</td>
      <td>-1.689554</td>
      <td>-0.228456</td>
      <td>2.871002</td>
      <td>-0.433597</td>
      <td>...</td>
      <td>1.522817</td>
      <td>1.645983</td>
      <td>1.595502</td>
      <td>2.465247</td>
      <td>-0.532987</td>
      <td>1.126289</td>
      <td>-0.302589</td>
      <td>0.773483</td>
      <td>3.884857</td>
      <td>0.729557</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.632151</td>
      <td>0.964321</td>
      <td>0.830229</td>
      <td>0.696598</td>
      <td>0.639204</td>
      <td>0.058108</td>
      <td>-0.736189</td>
      <td>0.712095</td>
      <td>1.467498</td>
      <td>0.320727</td>
      <td>...</td>
      <td>1.222602</td>
      <td>1.790727</td>
      <td>1.763590</td>
      <td>2.945772</td>
      <td>-2.532464</td>
      <td>1.460699</td>
      <td>2.732595</td>
      <td>0.097982</td>
      <td>2.566064</td>
      <td>0.652853</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.585766</td>
      <td>2.862437</td>
      <td>0.922291</td>
      <td>0.370000</td>
      <td>0.723932</td>
      <td>2.487161</td>
      <td>-1.916624</td>
      <td>-0.300359</td>
      <td>2.050980</td>
      <td>-0.064301</td>
      <td>...</td>
      <td>0.599305</td>
      <td>1.302091</td>
      <td>0.509717</td>
      <td>3.090268</td>
      <td>-1.745613</td>
      <td>0.168043</td>
      <td>0.851346</td>
      <td>-0.640472</td>
      <td>5.800712</td>
      <td>0.031888</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.802866</td>
      <td>2.277038</td>
      <td>0.608559</td>
      <td>2.180283</td>
      <td>0.116453</td>
      <td>2.539035</td>
      <td>-1.656839</td>
      <td>-1.420540</td>
      <td>2.605192</td>
      <td>-0.160302</td>
      <td>...</td>
      <td>2.015663</td>
      <td>2.823588</td>
      <td>2.101625</td>
      <td>3.521299</td>
      <td>-1.212391</td>
      <td>1.485369</td>
      <td>2.449296</td>
      <td>2.032116</td>
      <td>3.888917</td>
      <td>3.036650</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.868548</td>
      <td>2.480999</td>
      <td>1.079364</td>
      <td>2.413862</td>
      <td>0.961743</td>
      <td>2.280195</td>
      <td>-1.740610</td>
      <td>-0.472692</td>
      <td>3.338063</td>
      <td>-0.509144</td>
      <td>...</td>
      <td>1.142139</td>
      <td>1.251832</td>
      <td>-0.145789</td>
      <td>2.057217</td>
      <td>-2.862230</td>
      <td>-0.089721</td>
      <td>1.020832</td>
      <td>0.040589</td>
      <td>4.925848</td>
      <td>0.575977</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 46 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to evaluate the learned model structures.</span>
<span class="k">def</span> <span class="nf">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">true_model</span><span class="p">):</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">estimated_model</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
    <span class="n">est_adj</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span>
        <span class="n">estimated_model</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">(),</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">true_adj</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span>
        <span class="n">true_model</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">(),</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>

    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">true_adj</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">est_adj</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1-score for the model skeleton: &quot;</span><span class="p">,</span> <span class="n">f1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="1.-PC-algorithm">
<h2>1. PC algorithm<a class="headerlink" href="#1.-PC-algorithm" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the discrete variable alarm model back</span>

<span class="n">est</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">alarm_samples</span><span class="p">)</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">ci_test</span><span class="o">=</span><span class="s1">&#39;chi_square&#39;</span><span class="p">,</span> <span class="n">variant</span><span class="o">=</span><span class="s2">&quot;stable&quot;</span><span class="p">,</span> <span class="n">max_cond_vars</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dag&#39;</span><span class="p">)</span>
<span class="n">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">alarm_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c277a6a8093a4592a2a3bbf953cb5f27", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy:Reached maximum number of allowed conditional variables. Exiting
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F1-score for the model skeleton:  0.825
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the continuous variable ecoli model back</span>

<span class="n">est</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ecoli_samples</span><span class="p">)</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">ci_test</span><span class="o">=</span><span class="s1">&#39;pearsonr&#39;</span><span class="p">,</span> <span class="n">variant</span><span class="o">=</span><span class="s2">&quot;orig&quot;</span><span class="p">,</span> <span class="n">max_cond_vars</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dag&#39;</span><span class="p">)</span>
<span class="n">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">ecoli_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a3b6e02f74ff48fcaa9b4d2efd710852", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy:Reached maximum number of allowed conditional variables. Exiting
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F1-score for the model skeleton:  0.640625
</pre></div></div>
</div>
</section>
<section id="2.-Hill-Climb-Search-Algorithm">
<h2>2. Hill-Climb Search Algorithm<a class="headerlink" href="#2.-Hill-Climb-Search-Algorithm" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the discrete variable alarm model back</span>

<span class="n">est</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">alarm_samples</span><span class="p">)</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;k2&quot;</span><span class="p">,</span> <span class="n">max_indegree</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="n">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">alarm_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fb1cfeeaedad4c6fad37acd97fa383b0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F1-score for the model skeleton:  0.7719298245614035
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the continuous variable ecoli model back</span>

<span class="n">est</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ecoli_samples</span><span class="p">)</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;bic-g&quot;</span><span class="p">,</span> <span class="n">max_indegree</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="n">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">ecoli_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5649aa3962c94e7aa2151c1e022d1545", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F1-score for the model skeleton:  0.7692307692307693
</pre></div></div>
</div>
<section id="3.-GES-algorithm">
<h3>3. GES algorithm<a class="headerlink" href="#3.-GES-algorithm" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the discrete variable alarm model back</span>

<span class="n">est</span> <span class="o">=</span> <span class="n">GES</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">alarm_samples</span><span class="p">)</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;bic-d&quot;</span><span class="p">)</span>
<span class="n">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">alarm_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;INTUBATION&#39;: &#39;C&#39;, &#39;ANAPHYLAXIS&#39;: &#39;C&#39;, &#39;VENTLUNG&#39;: &#39;C&#39;, &#39;HISTORY&#39;: &#39;C&#39;, &#39;LVEDVOLUME&#39;: &#39;C&#39;, &#39;VENTMACH&#39;: &#39;C&#39;, &#39;TPR&#39;: &#39;C&#39;, &#39;MINVOL&#39;: &#39;C&#39;, &#39;VENTTUBE&#39;: &#39;C&#39;, &#39;HRBP&#39;: &#39;C&#39;, &#39;BP&#39;: &#39;C&#39;, &#39;PAP&#39;: &#39;C&#39;, &#39;PULMEMBOLUS&#39;: &#39;C&#39;, &#39;DISCONNECT&#39;: &#39;C&#39;, &#39;ERRLOWOUTPUT&#39;: &#39;C&#39;, &#39;HYPOVOLEMIA&#39;: &#39;C&#39;, &#39;CVP&#39;: &#39;C&#39;, &#39;HREKG&#39;: &#39;C&#39;, &#39;CO&#39;: &#39;C&#39;, &#39;PRESS&#39;: &#39;C&#39;, &#39;HRSAT&#39;: &#39;C&#39;, &#39;CATECHOL&#39;: &#39;C&#39;, &#39;EXPCO2&#39;: &#39;C&#39;, &#39;PVSAT&#39;: &#39;C&#39;, &#39;ARTCO2&#39;: &#39;C&#39;, &#39;LVFAILURE&#39;: &#39;C&#39;, &#39;KINKEDTUBE&#39;: &#39;C&#39;, &#39;VENTALV&#39;: &#39;C&#39;, &#39;FIO2&#39;: &#39;C&#39;, &#39;SHUNT&#39;: &#39;C&#39;, &#39;PCWP&#39;: &#39;C&#39;, &#39;SAO2&#39;: &#39;C&#39;, &#39;HR&#39;: &#39;C&#39;, &#39;MINVOLSET&#39;: &#39;C&#39;, &#39;STROKEVOLUME&#39;: &#39;C&#39;, &#39;INSUFFANESTH&#39;: &#39;C&#39;, &#39;ERRCAUTER&#39;: &#39;C&#39;}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F1-score for the model skeleton:  0.8444444444444444
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning the continuous variable ecoli model back</span>

<span class="n">est</span> <span class="o">=</span> <span class="n">GES</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ecoli_samples</span><span class="p">)</span>
<span class="n">estimated_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;bic-g&quot;</span><span class="p">)</span>
<span class="n">get_f1_score</span><span class="p">(</span><span class="n">estimated_model</span><span class="p">,</span> <span class="n">ecoli_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
INFO:pgmpy: Datatype (N=numerical, C=Categorical Unordered, O=Categorical Ordered) inferred from data:
 {&#39;b1191&#39;: &#39;N&#39;, &#39;cspG&#39;: &#39;N&#39;, &#39;eutG&#39;: &#39;N&#39;, &#39;fixC&#39;: &#39;N&#39;, &#39;cspA&#39;: &#39;N&#39;, &#39;yecO&#39;: &#39;N&#39;, &#39;yedE&#39;: &#39;N&#39;, &#39;sucA&#39;: &#39;N&#39;, &#39;cchB&#39;: &#39;N&#39;, &#39;yceP&#39;: &#39;N&#39;, &#39;ygbD&#39;: &#39;N&#39;, &#39;yjbO&#39;: &#39;N&#39;, &#39;yfiA&#39;: &#39;N&#39;, &#39;lpdA&#39;: &#39;N&#39;, &#39;pspB&#39;: &#39;N&#39;, &#39;atpG&#39;: &#39;N&#39;, &#39;dnaJ&#39;: &#39;N&#39;, &#39;flgD&#39;: &#39;N&#39;, &#39;gltA&#39;: &#39;N&#39;, &#39;sucD&#39;: &#39;N&#39;, &#39;tnaA&#39;: &#39;N&#39;, &#39;ygcE&#39;: &#39;N&#39;, &#39;yhdM&#39;: &#39;N&#39;, &#39;ibpB&#39;: &#39;N&#39;, &#39;yfaD&#39;: &#39;N&#39;, &#39;hupB&#39;: &#39;N&#39;, &#39;pspA&#39;: &#39;N&#39;, &#39;asnA&#39;: &#39;N&#39;, &#39;atpD&#39;: &#39;N&#39;, &#39;nmpC&#39;: &#39;N&#39;, &#39;icdA&#39;: &#39;N&#39;, &#39;lacA&#39;: &#39;N&#39;, &#39;yheI&#39;: &#39;N&#39;, &#39;aceB&#39;: &#39;N&#39;, &#39;lacY&#39;: &#39;N&#39;, &#39;b1963&#39;: &#39;N&#39;, &#39;dnaK&#39;: &#39;N&#39;, &#39;folK&#39;: &#39;N&#39;, &#39;ycgX&#39;: &#39;N&#39;, &#39;lacZ&#39;: &#39;N&#39;, &#39;nuoM&#39;: &#39;N&#39;, &#39;dnaG&#39;: &#39;N&#39;, &#39;b1583&#39;: &#39;N&#39;, &#39;mopB&#39;: &#39;N&#39;, &#39;yaeM&#39;: &#39;N&#39;, &#39;ftsJ&#39;: &#39;N&#39;}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
F1-score for the model skeleton:  0.8461538461538461
</pre></div></div>
</div>
</section>
</section>
<section id="4.-Expert-In-Loop-Algorithm">
<h2>4. Expert In Loop Algorithm<a class="headerlink" href="#4.-Expert-In-Loop-Algorithm" title="Link to this heading">¶</a></h2>
<p>Please refer to the following blogpost for more details: <a class="reference external" href="https://medium.com/gopenai/llms-for-causal-discovery-745e2cba0b59">https://medium.com/gopenai/llms-for-causal-discovery-745e2cba0b59</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
  </a>
</p>









<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../started/base.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples.html#defining-bayesian-networks">Defining Bayesian Networks</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#causal-discovery-structure-learning">Causal Discovery / Structure Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#parameter-estimation">Parameter Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#probabilistic-inference">Probabilistic Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#causal-inference">Causal Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#simulations">Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#extending-pgmpy">Extending pgmpy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/base.html">Supported Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../factors/base.html">Parameterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/base.html">Probabilistic Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../causal_infer/base.html">Causal Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../param_estimator/base.html">Parameter Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure_estimator/base.html">Causal Discovery / Structure Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metrics for Testing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readwrite/base.html">Reading/Writing to File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial Notebooks</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../examples.html">Examples</a><ul>
      <li>Previous: <a href="Basic_Operations_on_BN.html" title="previous chapter">Basic Operations on Bayesian Networks</a></li>
      <li>Next: <a href="Structure_Learning_Chow_Liu.html" title="next chapter">Learning Tree Structure from Data using the Chow-Liu Algorithm</a></li>
  </ul></li>
  </ul></li>
</ul>
</div><script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>

<div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="horizontal"></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HCFR07M31W');
</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Ankur Ankan.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/examples/Structure_Learning.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>