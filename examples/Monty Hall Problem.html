<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Monty Hall Problem &#8212; pgmpy 0.1.23 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=7b53859b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=20522496"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulating Data From Bayesian Networks" href="Simulating%20Data.html" />
    <link rel="prev" title="Causal Games" href="Causal%20Games.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Monty-Hall-Problem">
<h1>Monty Hall Problem<a class="headerlink" href="#Monty-Hall-Problem" title="Link to this heading">¶</a></h1>
<section id="Problem-Description:">
<h2>Problem Description:<a class="headerlink" href="#Problem-Description:" title="Link to this heading">¶</a></h2>
<p>The Monty Hall Problem is a very famous problem in Probability Theory. The question goes like:</p>
<p>Suppose you’re on a game show, and you’re given the choice of three doors: Behind one door is a car; behind the others, goats. You pick a door, say No. 1, and the host, who knows what’s behind the doors, opens another door, say No. 3, which has a goat. He then says to you, “Do you want to pick door No. 2?” Is it to your advantage to switch your choice?</p>
<p>By intution it seems that there shouldn’t be any benefit of switching the door. But using Bayes’ Theorem we can show that by switching the door the contestant has more chances of winning.</p>
<p>You can also checkout the wikipedia page: <a class="reference external" href="https://en.wikipedia.org/wiki/Monty_Hall_problem">https://en.wikipedia.org/wiki/Monty_Hall_problem</a></p>
</section>
<section id="Probabilistic-Interpretetion:">
<h2>Probabilistic Interpretetion:<a class="headerlink" href="#Probabilistic-Interpretetion:" title="Link to this heading">¶</a></h2>
<p>So have 3 random variables Contestant <img class="math" src="../_images/math/30aa7f35bdf564f98960638cce6708c0f3e1138c.png" alt="C \in \{1, 2, 3\}"/>, Host <img class="math" src="../_images/math/fe3491a183df541d7e3a6d093d8337733d8e989f.png" alt="H \in \{1, 2, 3\}"/> and prize <img class="math" src="../_images/math/80ecc432904f8bcfeb154953386033ec10ea866b.png" alt="P \in \{1, 2, 3 \}"/>. The prize has been put randomly behind the doors therefore: <img class="math" src="../_images/math/7567b3bcac0736a751c0435e1d0c57db29378861.png" alt="P(P=1) = P(P=2) = P(P=3) = \frac{1}{3}"/>. Also, the contestant is going to choose the door randomly, therefore: <img class="math" src="../_images/math/cb6ee3b0af0715ed6684b85719a326055f793b95.png" alt="P(C=1) = P(C=2) = P(C=3) = \frac{1}{3}"/>. For this problem we can build a Bayesian Network structure like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;images/monty.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Monty_Hall_Problem_3_0.png" src="../_images/examples_Monty_Hall_Problem_3_0.png" />
</div>
</div>
<p>with the following CPDs:</p>
<pre>

P(C):
+----------+----------+-----------+-----------+
|    C     |     0    |     1     |      2    |
+----------+----------+-----------+-----------+
|          |    0.33  |    0.33   |    0.33   |
+----------+----------+-----------+-----------+

P(P):
+----------+----------+-----------+-----------+
|    P     |     0    |     1     |      2    |
+----------+----------+-----------+-----------+
|          |    0.33  |    0.33   |    0.33   |
+----------+----------+-----------+-----------+

P(H | P, C):
+------+------+------+------+------+------+------+------+------+------+
|   C  |          0         |          1         |          2         |
+------+------+------+------+------+------+------+------+------+------+
|   P  |   0  |   1  |   2  |   0  |   1  |   2  |   0  |   1  |   2  |
+------+------+------+------+------+------+------+------+------+------+
|  H=0 |   0  |   0  |   0  |   0  |  0.5 |   1  |   0  |   1  |  0.5 |
+------+------+------+------+------+------+------+------+------+------+
|  H=1 |  0.5 |   0  |   1  |   0  |   0  |   0  |   1  |   0  |  0.5 |
+------+------+------+------+------+------+------+------+------+------+
|  H=2 |  0.5 |   1  |   0  |   1  |  0.5 |   0  |   0  |   0  |   0  |
+------+------+------+------+------+------+------+------+------+------+
</pre><p>Let’s say that the contestant selected door 0 and the host opened door 2, we need to find the probability of the prize i.e. <img class="math" src="../_images/math/b90de89d93fa4b4e7d162a8556308caaaf263887.png" alt="P(P|H=2, C=0)"/>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>

<span class="c1"># Defining the network structure</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">)])</span>

<span class="c1"># Defining the CPDs:</span>
<span class="n">cpd_c</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.33</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">]])</span>
<span class="n">cpd_p</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.33</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.33</span><span class="p">]])</span>
<span class="n">cpd_h</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span>
    <span class="s2">&quot;H&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">],</span>
    <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Associating the CPDs with the network structure.</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_c</span><span class="p">,</span> <span class="n">cpd_p</span><span class="p">,</span> <span class="n">cpd_h</span><span class="p">)</span>

<span class="c1"># Some other methods</span>
<span class="n">model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Finding Elimination Order: : : 0it [00:19, ?it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;TabularCPD representing P(C:3) at 0x7f580a175310&gt;,
 &lt;TabularCPD representing P(P:3) at 0x7f58128ad520&gt;,
 &lt;TabularCPD representing P(H:3 | C:3, P:3) at 0x7f580a175340&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check_model check for the model structure and the associated CPD and returns True if everything is correct otherwise throws an exception</span>
<span class="n">model</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Infering the posterior probability</span>
<span class="kn">from</span> <span class="nn">pgmpy.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>

<span class="n">infer</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">posterior_p</span> <span class="o">=</span> <span class="n">infer</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">posterior_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Finding Elimination Order: : : 0it [00:00, ?it/s]
0it [00:00, ?it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
+------+----------+
| P    |   phi(P) |
+======+==========+
| P(0) |   0.3333 |
+------+----------+
| P(1) |   0.6667 |
+------+----------+
| P(2) |   0.0000 |
+------+----------+
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>We see that the posterior probability of having the prize behind door 1 is more that door 0. Therefore the contestant should switch the door.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../started/base.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base/base.html">Base Model Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/base.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../factors/base.html">Parameterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exact_infer/base.html">Exact Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exact_infer/model_testing.html">Model Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../approx_infer/base.html">Approximate Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../param_estimator/base.html">Parameter Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure_estimator/base.html">Structure Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metrics for testing models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readwrite/base.html">Reading/Writing to File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting.html">Plotting Models</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Example Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Creating%20a%20Discrete%20Bayesian%20Network.html">Creating Discrete Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Basic%20Operations%20on%20Bayesian%20Network.html">Basic Operations on Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Learning%20Parameters%20in%20Discrete%20Bayesian%20Networks.html">Parameter Learning in Discrete Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Structure%20Learning%20in%20Bayesian%20Networks.html">Structure Learning in Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Structure%20Learning%20with%20Chow-Liu.html">Learning Tree Structure from Data using the Chow-Liu Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="Structure%20Learning%20with%20TAN.html">Learning Tree-augmented Naive Bayes (TAN) Structure from Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Inference%20in%20Discrete%20Bayesian%20Networks.html">Inference in Discrete Bayesian Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="Causal%20Inference.html">Causal Inference Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Causal%20Games.html">Causal Games</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Monty Hall Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="Simulating%20Data.html">Simulating Data From Bayesian Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="Extending%20pgmpy.html">Extending pgmpy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial Notebooks</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../examples.html">Example Notebooks</a><ul>
      <li>Previous: <a href="Causal%20Games.html" title="previous chapter">Causal Games</a></li>
      <li>Next: <a href="Simulating%20Data.html" title="next chapter">Simulating Data From Bayesian Networks</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>







<script async src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>

<div data-ea-publisher="pgmpyorg" data-ea-type="image" data-ea-style="horizontal"></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-HCFR07M31W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HCFR07M31W');
</script>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Ankur Ankan.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/examples/Monty Hall Problem.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>